(function(F,M){typeof exports=="object"&&typeof module<"u"?M(require("yargs"),require("util"),require("path"),require("fs"),require("assert"),require("url"),require("@vue/compiler-sfc")):typeof define=="function"&&define.amd?define(["yargs","util","path","fs","assert","url","@vue/compiler-sfc"],M):(F=typeof globalThis<"u"?globalThis:F||self,M(F.yargs,F.util,F.path,F.fs,F.assert,F.url,F.compilerSfc))})(this,function(F,M,O,P,je,Ye,He){"use strict";var Se=typeof document<"u"?document.currentScript:null;class D extends Error{constructor(e){super(e||"yargs error"),this.name="YError",Error.captureStackTrace&&Error.captureStackTrace(this,D)}}function Ne(){return Ze()?0:1}function Ze(){return Xe()&&!process.defaultApp}function Xe(){return!!process.versions.electron}function Je(n){return n.slice(Ne()+1)}function ke(){return process.argv[Ne()]}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function K(n){if(n!==n.toLowerCase()&&n!==n.toUpperCase()||(n=n.toLowerCase()),n.indexOf("-")===-1&&n.indexOf("_")===-1)return n;{let s="",r=!1;const l=n.match(/^-+/);for(let f=l?l[0].length:0;f<n.length;f++){let d=n.charAt(f);r&&(r=!1,d=d.toUpperCase()),f!==0&&(d==="-"||d==="_")?r=!0:d!=="-"&&d!=="_"&&(s+=d)}return s}}function ve(n,e){const s=n.toLowerCase();e=e||"-";let r="";for(let l=0;l<n.length;l++){const f=s.charAt(l),d=n.charAt(l);f!==d&&l>0?r+=`${e}${s.charAt(l)}`:r+=d}return r}function Fe(n){return n==null?!1:typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^0[^.]/.test(n)?!1:/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function et(n){if(Array.isArray(n))return n.map(d=>typeof d!="string"?d+"":d);n=n.trim();let e=0,s=null,r=null,l=null;const f=[];for(let d=0;d<n.length;d++){if(s=r,r=n.charAt(d),r===" "&&!l){s!==" "&&e++;continue}r===l?l=null:(r==="'"||r==='"')&&!l&&(l=r),f[e]||(f[e]=""),f[e]+=r}return f}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var L;(function(n){n.BOOLEAN="boolean",n.STRING="string",n.NUMBER="number",n.ARRAY="array"})(L||(L={}));/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */let B;class tt{constructor(e){B=e}parse(e,s){const r=Object.assign({alias:void 0,array:void 0,boolean:void 0,config:void 0,configObjects:void 0,configuration:void 0,coerce:void 0,count:void 0,default:void 0,envPrefix:void 0,narg:void 0,normalize:void 0,string:void 0,number:void 0,__:void 0,key:void 0},s),l=et(e),f=typeof e=="string",d=nt(Object.assign(Object.create(null),r.alias)),m=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"parse-positional-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},r.configuration),E=Object.assign(Object.create(null),r.default),j=r.configObjects||[],A=r.envPrefix,I=m["populate--"],q=I?"--":"_",ue=Object.create(null),Ue=Object.create(null),U=r.__||B.format,a={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},T=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,we=new RegExp("^--"+m["negation-prefix"]+"(.+)");[].concat(r.array||[]).filter(Boolean).forEach(function(t){const i=typeof t=="object"?t.key:t,u=Object.keys(t).map(function(c){return{boolean:"bools",string:"strings",number:"numbers"}[c]}).filter(Boolean).pop();u&&(a[u][i]=!0),a.arrays[i]=!0,a.keys.push(i)}),[].concat(r.boolean||[]).filter(Boolean).forEach(function(t){a.bools[t]=!0,a.keys.push(t)}),[].concat(r.string||[]).filter(Boolean).forEach(function(t){a.strings[t]=!0,a.keys.push(t)}),[].concat(r.number||[]).filter(Boolean).forEach(function(t){a.numbers[t]=!0,a.keys.push(t)}),[].concat(r.count||[]).filter(Boolean).forEach(function(t){a.counts[t]=!0,a.keys.push(t)}),[].concat(r.normalize||[]).filter(Boolean).forEach(function(t){a.normalize[t]=!0,a.keys.push(t)}),typeof r.narg=="object"&&Object.entries(r.narg).forEach(([t,i])=>{typeof i=="number"&&(a.nargs[t]=i,a.keys.push(t))}),typeof r.coerce=="object"&&Object.entries(r.coerce).forEach(([t,i])=>{typeof i=="function"&&(a.coercions[t]=i,a.keys.push(t))}),typeof r.config<"u"&&(Array.isArray(r.config)||typeof r.config=="string"?[].concat(r.config).filter(Boolean).forEach(function(t){a.configs[t]=!0}):typeof r.config=="object"&&Object.entries(r.config).forEach(([t,i])=>{(typeof i=="boolean"||typeof i=="function")&&(a.configs[t]=i)})),sn(r.key,d,r.default,a.arrays),Object.keys(E).forEach(function(t){(a.aliases[t]||[]).forEach(function(i){E[i]=E[t]})});let W=null;fn();let he=[];const _=Object.assign(Object.create(null),{_:[]}),Ge={};for(let t=0;t<l.length;t++){const i=l[t],u=i.replace(/^-{3,}/,"---");let c,o,p,h,g,w;if(i!=="--"&&/^-/.test(i)&&me(i))Oe(i);else if(u.match(/^---+(=|$)/)){Oe(i);continue}else if(i.match(/^--.+=/)||!m["short-option-groups"]&&i.match(/^-.+=/))h=i.match(/^--?([^=]+)=([\s\S]*)$/),h!==null&&Array.isArray(h)&&h.length>=3&&(y(h[1],a.arrays)?t=de(t,h[1],l,h[2]):y(h[1],a.nargs)!==!1?t=pe(t,h[1],l,h[2]):b(h[1],h[2],!0));else if(i.match(we)&&m["boolean-negation"])h=i.match(we),h!==null&&Array.isArray(h)&&h.length>=2&&(o=h[1],b(o,y(o,a.arrays)?[!1]:!1));else if(i.match(/^--.+/)||!m["short-option-groups"]&&i.match(/^-[^-]+/))h=i.match(/^--?(.+)/),h!==null&&Array.isArray(h)&&h.length>=2&&(o=h[1],y(o,a.arrays)?t=de(t,o,l):y(o,a.nargs)!==!1?t=pe(t,o,l):(g=l[t+1],g!==void 0&&(!g.match(/^-/)||g.match(T))&&!y(o,a.bools)&&!y(o,a.counts)||/^(true|false)$/.test(g)?(b(o,g),t++):b(o,V(o))));else if(i.match(/^-.\..+=/))h=i.match(/^-([^=]+)=([\s\S]*)$/),h!==null&&Array.isArray(h)&&h.length>=3&&b(h[1],h[2]);else if(i.match(/^-.\..+/)&&!i.match(T))g=l[t+1],h=i.match(/^-(.\..+)/),h!==null&&Array.isArray(h)&&h.length>=2&&(o=h[1],g!==void 0&&!g.match(/^-/)&&!y(o,a.bools)&&!y(o,a.counts)?(b(o,g),t++):b(o,V(o)));else if(i.match(/^-[^-]+/)&&!i.match(T)){p=i.slice(1,-1).split(""),c=!1;for(let x=0;x<p.length;x++){if(g=i.slice(x+2),p[x+1]&&p[x+1]==="="){w=i.slice(x+3),o=p[x],y(o,a.arrays)?t=de(t,o,l,w):y(o,a.nargs)!==!1?t=pe(t,o,l,w):b(o,w),c=!0;break}if(g==="-"){b(p[x],g);continue}if(/[A-Za-z]/.test(p[x])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(g)&&y(g,a.bools)===!1){b(p[x],g),c=!0;break}if(p[x+1]&&p[x+1].match(/\W/)){b(p[x],g),c=!0;break}else b(p[x],V(p[x]))}o=i.slice(-1)[0],!c&&o!=="-"&&(y(o,a.arrays)?t=de(t,o,l):y(o,a.nargs)!==!1?t=pe(t,o,l):(g=l[t+1],g!==void 0&&(!/^(-|--)[^-]/.test(g)||g.match(T))&&!y(o,a.bools)&&!y(o,a.counts)||/^(true|false)$/.test(g)?(b(o,g),t++):b(o,V(o))))}else if(i.match(/^-[0-9]$/)&&i.match(T)&&y(i.slice(1),a.bools))o=i.slice(1),b(o,V(o));else if(i==="--"){he=l.slice(t+1);break}else if(m["halt-at-non-option"]){he=l.slice(t);break}else Oe(i)}De(_,!0),De(_,!1),kt(_),en(),Ke(_,a.aliases,E,!0),tn(_),m["set-placeholder-key"]&&nn(_),Object.keys(a.counts).forEach(function(t){ce(_,t.split("."))||b(t,0)}),I&&he.length&&(_[q]=[]),he.forEach(function(t){_[q].push(t)}),m["camel-case-expansion"]&&m["strip-dashed"]&&Object.keys(_).filter(t=>t!=="--"&&t.includes("-")).forEach(t=>{delete _[t]}),m["strip-aliased"]&&[].concat(...Object.keys(d).map(t=>d[t])).forEach(t=>{m["camel-case-expansion"]&&t.includes("-")&&delete _[t.split(".").map(i=>K(i)).join(".")],delete _[t]});function Oe(t){const i=ge("_",t);(typeof i=="string"||typeof i=="number")&&_._.push(i)}function pe(t,i,u,c){let o,p=y(i,a.nargs);if(p=typeof p!="number"||isNaN(p)?1:p,p===0)return z(c)||(W=Error(U("Argument unexpected for: %s",i))),b(i,V(i)),t;let h=z(c)?0:1;if(m["nargs-eats-options"])u.length-(t+1)+h<p&&(W=Error(U("Not enough arguments following: %s",i))),h=p;else{for(o=t+1;o<u.length&&(!u[o].match(/^-[^0-9]/)||u[o].match(T)||me(u[o]));o++)h++;h<p&&(W=Error(U("Not enough arguments following: %s",i)))}let g=Math.min(h,p);for(!z(c)&&g>0&&(b(i,c),g--),o=t+1;o<g+t+1;o++)b(i,u[o]);return t+g}function de(t,i,u,c){let o=[],p=c||u[t+1];const h=y(i,a.nargs);if(y(i,a.bools)&&!/^(true|false)$/.test(p))o.push(!0);else if(z(p)||z(c)&&/^-/.test(p)&&!T.test(p)&&!me(p)){if(E[i]!==void 0){const g=E[i];o=Array.isArray(g)?g:[g]}}else{z(c)||o.push(xe(i,c,!0));for(let g=t+1;g<u.length&&!(!m["greedy-arrays"]&&o.length>0||h&&typeof h=="number"&&o.length>=h||(p=u[g],/^-/.test(p)&&!T.test(p)&&!me(p)));g++)t=g,o.push(xe(i,p,f))}return typeof h=="number"&&(h&&o.length<h||isNaN(h)&&o.length===0)&&(W=Error(U("Not enough arguments following: %s",i))),b(i,o),t}function b(t,i,u=f){if(/-/.test(t)&&m["camel-case-expansion"]){const p=t.split(".").map(function(h){return K(h)}).join(".");Ve(t,p)}const c=xe(t,i,u),o=t.split(".");le(_,o,c),a.aliases[t]&&a.aliases[t].forEach(function(p){const h=p.split(".");le(_,h,c)}),o.length>1&&m["dot-notation"]&&(a.aliases[o[0]]||[]).forEach(function(p){let h=p.split(".");const g=[].concat(o);g.shift(),h=h.concat(g),(a.aliases[t]||[]).includes(h.join("."))||le(_,h,c)}),y(t,a.normalize)&&!y(t,a.arrays)&&[t].concat(a.aliases[t]||[]).forEach(function(h){Object.defineProperty(Ge,h,{enumerable:!0,get(){return i},set(g){i=typeof g=="string"?B.normalize(g):g}})})}function Ve(t,i){a.aliases[t]&&a.aliases[t].length||(a.aliases[t]=[i],ue[i]=!0),a.aliases[i]&&a.aliases[i].length||Ve(i,t)}function xe(t,i,u){u&&(i=st(i)),(y(t,a.bools)||y(t,a.counts))&&typeof i=="string"&&(i=i==="true");let c=Array.isArray(i)?i.map(function(o){return ge(t,o)}):ge(t,i);return y(t,a.counts)&&(z(c)||typeof c=="boolean")&&(c=ye()),y(t,a.normalize)&&y(t,a.arrays)&&(Array.isArray(i)?c=i.map(o=>B.normalize(o)):c=B.normalize(i)),c}function ge(t,i){return!m["parse-positional-numbers"]&&t==="_"||!y(t,a.strings)&&!y(t,a.bools)&&!Array.isArray(i)&&(Fe(i)&&m["parse-numbers"]&&Number.isSafeInteger(Math.floor(parseFloat(`${i}`)))||!z(i)&&y(t,a.numbers))&&(i=Number(i)),i}function kt(t){const i=Object.create(null);Ke(i,a.aliases,E),Object.keys(a.configs).forEach(function(u){const c=t[u]||i[u];if(c)try{let o=null;const p=B.resolve(B.cwd(),c),h=a.configs[u];if(typeof h=="function"){try{o=h(p)}catch(g){o=g}if(o instanceof Error){W=o;return}}else o=B.require(p);Ce(o)}catch(o){o.name==="PermissionDenied"?W=o:t[u]&&(W=Error(U("Invalid JSON config file: %s",c)))}})}function Ce(t,i){Object.keys(t).forEach(function(u){const c=t[u],o=i?i+"."+u:u;typeof c=="object"&&c!==null&&!Array.isArray(c)&&m["dot-notation"]?Ce(c,o):(!ce(_,o.split("."))||y(o,a.arrays)&&m["combine-arrays"])&&b(o,c)})}function en(){typeof j<"u"&&j.forEach(function(t){Ce(t)})}function De(t,i){if(typeof A>"u")return;const u=typeof A=="string"?A:"",c=B.env();Object.keys(c).forEach(function(o){if(u===""||o.lastIndexOf(u,0)===0){const p=o.split("__").map(function(h,g){return g===0&&(h=h.substring(u.length)),K(h)});(i&&a.configs[p.join(".")]||!i)&&!ce(t,p)&&b(p.join("."),c[o])}})}function tn(t){let i;const u=new Set;Object.keys(t).forEach(function(c){if(!u.has(c)&&(i=y(c,a.coercions),typeof i=="function"))try{const o=ge(c,i(t[c]));[].concat(a.aliases[c]||[],c).forEach(p=>{u.add(p),t[p]=o})}catch(o){W=o}})}function nn(t){return a.keys.forEach(i=>{~i.indexOf(".")||typeof t[i]>"u"&&(t[i]=void 0)}),t}function Ke(t,i,u,c=!1){Object.keys(u).forEach(function(o){ce(t,o.split("."))||(le(t,o.split("."),u[o]),c&&(Ue[o]=!0),(i[o]||[]).forEach(function(p){ce(t,p.split("."))||le(t,p.split("."),u[o])}))})}function ce(t,i){let u=t;m["dot-notation"]||(i=[i.join(".")]),i.slice(0,-1).forEach(function(o){u=u[o]||{}});const c=i[i.length-1];return typeof u!="object"?!1:c in u}function le(t,i,u){let c=t;m["dot-notation"]||(i=[i.join(".")]),i.slice(0,-1).forEach(function(w){w=Le(w),typeof c=="object"&&c[w]===void 0&&(c[w]={}),typeof c[w]!="object"||Array.isArray(c[w])?(Array.isArray(c[w])?c[w].push({}):c[w]=[c[w],{}],c=c[w][c[w].length-1]):c=c[w]});const o=Le(i[i.length-1]),p=y(i.join("."),a.arrays),h=Array.isArray(u);let g=m["duplicate-arguments-array"];!g&&y(o,a.nargs)&&(g=!0,(!z(c[o])&&a.nargs[o]===1||Array.isArray(c[o])&&c[o].length===a.nargs[o])&&(c[o]=void 0)),u===ye()?c[o]=ye(c[o]):Array.isArray(c[o])?g&&p&&h?c[o]=m["flatten-duplicate-arrays"]?c[o].concat(u):(Array.isArray(c[o][0])?c[o]:[c[o]]).concat([u]):!g&&!!p==!!h?c[o]=u:c[o]=c[o].concat([u]):c[o]===void 0&&p?c[o]=h?u:[u]:g&&!(c[o]===void 0||y(o,a.counts)||y(o,a.bools))?c[o]=[c[o],u]:c[o]=u}function sn(...t){t.forEach(function(i){Object.keys(i||{}).forEach(function(u){a.aliases[u]||(a.aliases[u]=[].concat(d[u]||[]),a.aliases[u].concat(u).forEach(function(c){if(/-/.test(c)&&m["camel-case-expansion"]){const o=K(c);o!==u&&a.aliases[u].indexOf(o)===-1&&(a.aliases[u].push(o),ue[o]=!0)}}),a.aliases[u].concat(u).forEach(function(c){if(c.length>1&&/[A-Z]/.test(c)&&m["camel-case-expansion"]){const o=ve(c,"-");o!==u&&a.aliases[u].indexOf(o)===-1&&(a.aliases[u].push(o),ue[o]=!0)}}),a.aliases[u].forEach(function(c){a.aliases[c]=[u].concat(a.aliases[u].filter(function(o){return c!==o}))}))})})}function y(t,i){const u=[].concat(a.aliases[t]||[],t),c=Object.keys(i),o=u.find(p=>c.includes(p));return o?i[o]:!1}function Qe(t){const i=Object.keys(a);return[].concat(i.map(c=>a[c])).some(function(c){return Array.isArray(c)?c.includes(t):c[t]})}function on(t,...i){return[].concat(...i).some(function(c){const o=t.match(c);return o&&Qe(o[1])})}function rn(t){if(t.match(T)||!t.match(/^-[^-]+/))return!1;let i=!0,u;const c=t.slice(1).split("");for(let o=0;o<c.length;o++){if(u=t.slice(o+2),!Qe(c[o])){i=!1;break}if(c[o+1]&&c[o+1]==="="||u==="-"||/[A-Za-z]/.test(c[o])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(u)||c[o+1]&&c[o+1].match(/\W/))break}return i}function me(t){return m["unknown-options-as-args"]&&cn(t)}function cn(t){return t=t.replace(/^-{3,}/,"--"),t.match(T)||rn(t)?!1:!on(t,/^-+([^=]+?)=[\s\S]*$/,we,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}function V(t){return!y(t,a.bools)&&!y(t,a.counts)&&`${t}`in E?E[t]:ln(an(t))}function ln(t){return{[L.BOOLEAN]:!0,[L.STRING]:"",[L.NUMBER]:void 0,[L.ARRAY]:[]}[t]}function an(t){let i=L.BOOLEAN;return y(t,a.strings)?i=L.STRING:y(t,a.numbers)?i=L.NUMBER:y(t,a.bools)?i=L.BOOLEAN:y(t,a.arrays)&&(i=L.ARRAY),i}function z(t){return t===void 0}function fn(){Object.keys(a.counts).find(t=>y(t,a.arrays)?(W=Error(U("Invalid configuration: %s, opts.count excludes opts.array.",t)),!0):y(t,a.nargs)?(W=Error(U("Invalid configuration: %s, opts.count excludes opts.narg.",t)),!0):!1)}return{aliases:Object.assign({},a.aliases),argv:Object.assign(Ge,_),configuration:m,defaulted:Object.assign({},Ue),error:W,newAliases:Object.assign({},ue)}}}function nt(n){const e=[],s=Object.create(null);let r=!0;for(Object.keys(n).forEach(function(l){e.push([].concat(n[l],l))});r;){r=!1;for(let l=0;l<e.length;l++)for(let f=l+1;f<e.length;f++)if(e[l].filter(function(m){return e[f].indexOf(m)!==-1}).length){e[l]=e[l].concat(e[f]),e.splice(f,1),r=!0;break}}return e.forEach(function(l){l=l.filter(function(d,m,E){return E.indexOf(d)===m});const f=l.pop();f!==void 0&&typeof f=="string"&&(s[f]=l)}),s}function ye(n){return n!==void 0?n+1:1}function Le(n){return n==="__proto__"?"___proto___":n}function st(n){return typeof n=="string"&&(n[0]==="'"||n[0]==='"')&&n[n.length-1]===n[0]?n.substring(1,n.length-1):n}/**
 * @fileoverview Main entrypoint for libraries using yargs-parser in Node.js
 * CJS and ESM environments.
 *
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var be,Ee,$e;const Re=process&&process.env&&process.env.YARGS_MIN_NODE_VERSION?Number(process.env.YARGS_MIN_NODE_VERSION):12,We=(Ee=(be=process==null?void 0:process.versions)===null||be===void 0?void 0:be.node)!==null&&Ee!==void 0?Ee:($e=process==null?void 0:process.version)===null||$e===void 0?void 0:$e.slice(1);if(We&&Number(We.match(/^([^.]+)/)[1])<Re)throw Error(`yargs parser supports a minimum Node.js version of ${Re}. Read our version support policy: https://github.com/yargs/yargs-parser#supported-nodejs-versions`);const ot=process?process.env:{},Pe=new tt({cwd:process.cwd,env:()=>ot,format:M.format,normalize:O.normalize,resolve:O.resolve,require:n=>{if(typeof require<"u")return require(n);if(n.match(/\.json$/))return JSON.parse(P.readFileSync(n,"utf8"));throw Error("only .json config files are supported in ESM")}}),Q=function(e,s){return Pe.parse(e.slice(),s).argv};Q.detailed=function(n,e){return Pe.parse(n.slice(),e)},Q.camelCase=K,Q.decamelize=ve,Q.looksLikeNumber=Fe;const it={right:ut,center:ht},rt=0,ae=1,ct=2,fe=3;class lt{constructor(e){var s;this.width=e.width,this.wrap=(s=e.wrap)!==null&&s!==void 0?s:!0,this.rows=[]}span(...e){const s=this.div(...e);s.span=!0}resetOutput(){this.rows=[]}div(...e){if(e.length===0&&this.div(""),this.wrap&&this.shouldApplyLayoutDSL(...e)&&typeof e[0]=="string")return this.applyLayoutDSL(e[0]);const s=e.map(r=>typeof r=="string"?this.colFromString(r):r);return this.rows.push(s),s}shouldApplyLayoutDSL(...e){return e.length===1&&typeof e[0]=="string"&&/[\t\n]/.test(e[0])}applyLayoutDSL(e){const s=e.split(`
`).map(l=>l.split("	"));let r=0;return s.forEach(l=>{l.length>1&&C.stringWidth(l[0])>r&&(r=Math.min(Math.floor(this.width*.5),C.stringWidth(l[0])))}),s.forEach(l=>{this.div(...l.map((f,d)=>({text:f.trim(),padding:this.measurePadding(f),width:d===0&&l.length>1?r:void 0})))}),this.rows[this.rows.length-1]}colFromString(e){return{text:e,padding:this.measurePadding(e)}}measurePadding(e){const s=C.stripAnsi(e);return[0,s.match(/\s*$/)[0].length,0,s.match(/^\s*/)[0].length]}toString(){const e=[];return this.rows.forEach(s=>{this.rowToString(s,e)}),e.filter(s=>!s.hidden).map(s=>s.text).join(`
`)}rowToString(e,s){return this.rasterize(e).forEach((r,l)=>{let f="";r.forEach((d,m)=>{const{width:E}=e[m],j=this.negatePadding(e[m]);let A=d;if(j>C.stringWidth(d)&&(A+=" ".repeat(j-C.stringWidth(d))),e[m].align&&e[m].align!=="left"&&this.wrap){const q=it[e[m].align];A=q(A,j),C.stringWidth(A)<j&&(A+=" ".repeat((E||0)-C.stringWidth(A)-1))}const I=e[m].padding||[0,0,0,0];I[fe]&&(f+=" ".repeat(I[fe])),f+=Te(e[m],A,"| "),f+=A,f+=Te(e[m],A," |"),I[ae]&&(f+=" ".repeat(I[ae])),l===0&&s.length>0&&(f=this.renderInline(f,s[s.length-1]))}),s.push({text:f.replace(/ +$/,""),span:e.span})}),s}renderInline(e,s){const r=e.match(/^ */),l=r?r[0].length:0,f=s.text,d=C.stringWidth(f.trimRight());return s.span?this.wrap?l<d?e:(s.hidden=!0,f.trimRight()+" ".repeat(l-d)+e.trimLeft()):(s.hidden=!0,f+e):e}rasterize(e){const s=[],r=this.columnWidths(e);let l;return e.forEach((f,d)=>{f.width=r[d],this.wrap?l=C.wrap(f.text,this.negatePadding(f),{hard:!0}).split(`
`):l=f.text.split(`
`),f.border&&(l.unshift("."+"-".repeat(this.negatePadding(f)+2)+"."),l.push("'"+"-".repeat(this.negatePadding(f)+2)+"'")),f.padding&&(l.unshift(...new Array(f.padding[rt]||0).fill("")),l.push(...new Array(f.padding[ct]||0).fill(""))),l.forEach((m,E)=>{s[E]||s.push([]);const j=s[E];for(let A=0;A<d;A++)j[A]===void 0&&j.push("");j.push(m)})}),s}negatePadding(e){let s=e.width||0;return e.padding&&(s-=(e.padding[fe]||0)+(e.padding[ae]||0)),e.border&&(s-=4),s}columnWidths(e){if(!this.wrap)return e.map(d=>d.width||C.stringWidth(d.text));let s=e.length,r=this.width;const l=e.map(d=>{if(d.width)return s--,r-=d.width,d.width}),f=s?Math.floor(r/s):0;return l.map((d,m)=>d===void 0?Math.max(f,at(e[m])):d)}}function Te(n,e,s){return n.border?/[.']-+[.']/.test(e)?"":e.trim().length!==0?s:"  ":""}function at(n){const e=n.padding||[],s=1+(e[fe]||0)+(e[ae]||0);return n.border?s+4:s}function ft(){return typeof process=="object"&&process.stdout&&process.stdout.columns?process.stdout.columns:80}function ut(n,e){n=n.trim();const s=C.stringWidth(n);return s<e?" ".repeat(e-s)+n:n}function ht(n,e){n=n.trim();const s=C.stringWidth(n);return s>=e?n:" ".repeat(e-s>>1)+n}let C;function pt(n,e){return C=e,new lt({width:n?.width||ft(),wrap:n?.wrap})}const Be=new RegExp("\x1B(?:\\[(?:\\d+[ABCDEFGJKSTm]|\\d+;\\d+[Hfm]|\\d+;\\d+;\\d+m|6n|s|u|\\?25[lh])|\\w)","g");function Ie(n){return n.replace(Be,"")}function dt(n,e){const[s,r]=n.match(Be)||["",""];n=Ie(n);let l="";for(let f=0;f<n.length;f++)f!==0&&f%e===0&&(l+=`
`),l+=n.charAt(f);return s&&r&&(l=`${s}${l}${r}`),l}function gt(n){return pt(n,{stringWidth:e=>[...e].length,stripAnsi:Ie,wrap:dt})}function mt(n,e){let s=O.resolve(".",n),r;for(P.statSync(s).isDirectory()||(s=O.dirname(s));;){if(r=e(s,P.readdirSync(s)),r)return O.resolve(s,r);if(s=O.dirname(r=s),r===s)break}}const yt={fs:{readFileSync:P.readFileSync,writeFile:P.writeFile},format:M.format,resolve:O.resolve,exists:n=>{try{return P.statSync(n).isFile()}catch{return!1}}};let R;class bt{constructor(e){e=e||{},this.directory=e.directory||"./locales",this.updateFiles=typeof e.updateFiles=="boolean"?e.updateFiles:!0,this.locale=e.locale||"en",this.fallbackToLanguage=typeof e.fallbackToLanguage=="boolean"?e.fallbackToLanguage:!0,this.cache=Object.create(null),this.writeQueue=[]}__(...e){if(typeof arguments[0]!="string")return this._taggedLiteral(arguments[0],...arguments);const s=e.shift();let r=function(){};return typeof e[e.length-1]=="function"&&(r=e.pop()),r=r||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][s]&&this.updateFiles?(this.cache[this.locale][s]=s,this._enqueueWrite({directory:this.directory,locale:this.locale,cb:r})):r(),R.format.apply(R.format,[this.cache[this.locale][s]||s].concat(e))}__n(){const e=Array.prototype.slice.call(arguments),s=e.shift(),r=e.shift(),l=e.shift();let f=function(){};typeof e[e.length-1]=="function"&&(f=e.pop()),this.cache[this.locale]||this._readLocaleFile();let d=l===1?s:r;this.cache[this.locale][s]&&(d=this.cache[this.locale][s][l===1?"one":"other"]),!this.cache[this.locale][s]&&this.updateFiles?(this.cache[this.locale][s]={one:s,other:r},this._enqueueWrite({directory:this.directory,locale:this.locale,cb:f})):f();const m=[d];return~d.indexOf("%d")&&m.push(l),R.format.apply(R.format,m.concat(e))}setLocale(e){this.locale=e}getLocale(){return this.locale}updateLocale(e){this.cache[this.locale]||this._readLocaleFile();for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(this.cache[this.locale][s]=e[s])}_taggedLiteral(e,...s){let r="";return e.forEach(function(l,f){const d=s[f+1];r+=l,typeof d<"u"&&(r+="%s")}),this.__.apply(this,[r].concat([].slice.call(s,1)))}_enqueueWrite(e){this.writeQueue.push(e),this.writeQueue.length===1&&this._processWriteQueue()}_processWriteQueue(){const e=this,s=this.writeQueue[0],r=s.directory,l=s.locale,f=s.cb,d=this._resolveLocaleFile(r,l),m=JSON.stringify(this.cache[l],null,2);R.fs.writeFile(d,m,"utf-8",function(E){e.writeQueue.shift(),e.writeQueue.length>0&&e._processWriteQueue(),f(E)})}_readLocaleFile(){let e={};const s=this._resolveLocaleFile(this.directory,this.locale);try{R.fs.readFileSync&&(e=JSON.parse(R.fs.readFileSync(s,"utf-8")))}catch(r){if(r instanceof SyntaxError&&(r.message="syntax error in "+s),r.code==="ENOENT")e={};else throw r}this.cache[this.locale]=e}_resolveLocaleFile(e,s){let r=R.resolve(e,"./",s+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(r)&&~s.lastIndexOf("_")){const l=R.resolve(e,"./",s.split("_")[0]+".json");this._fileExistsSync(l)&&(r=l)}return r}_fileExistsSync(e){return R.exists(e)}}function Et(n,e){R=e;const s=new bt(n);return{__:s.__.bind(s),__n:s.__n.bind(s),setLocale:s.setLocale.bind(s),getLocale:s.getLocale.bind(s),updateLocale:s.updateLocale.bind(s),locale:s.locale}}const $t=n=>Et(n,yt),At="require is not supported by ESM",ze="loading a directory of commands is not supported yet for ESM";let Y;try{Y=Ye.fileURLToPath(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:Se&&Se.src||new URL("vue-mess-detector.umd.js",document.baseURI).href)}catch{Y=process.cwd()}const _t=Y.substring(0,Y.lastIndexOf("node_modules"));je.notStrictEqual,je.strictEqual,M.inspect,_t||process.cwd(),O.basename,O.dirname,O.extname,O.relative,O.resolve,process.cwd,process.exit,process.nextTick,typeof process.stdout.columns<"u"&&process.stdout.columns,P.readFileSync,$t({directory:O.resolve(Y,"../../../locales"),updateFiles:!1});const Ae="\x1B[44m",H="\x1B[43m",S="\x1B[41m",wt="\x1B[42m",$="\x1B[0m",N="\x1B[33m",v="\x1B[0m",_e=50,Z=[],Ot=(n,e)=>{const s=n.content.split(`
`);s.length>_e&&Z.push({fileName:e,scriptLength:s.length})},xt=()=>(Z.length>0&&(console.log(`
${S}Long <script> blocks${$} in ${Z.length} files.`),console.log(`ðŸ‘‰ ${N}Try to refactor out the logic into composable functions or other files and keep the script block's length under ${_e} lines.${v}`),Z.forEach(n=>{console.log(`- ${n.fileName} ${n.scriptLength>_e*2?S:H}(${n.scriptLength} lines)${$}`)})),Z.length),X=[],Ct=n=>{X.push(n)},jt=()=>(X.length>0&&(console.log(`
${H}Plain <script> blocks${$} in ${X.length} files.`),console.log(`ðŸ‘‰ ${N} Consider using <script setup> to leverage the new SFC <script> syntax.${v}`),X.forEach(n=>{console.log(`- ${n}`)})),X.length),J=[],St=(n,e)=>{const s=/\belse\b/gi,r=n.content.match(s);r?.length&&J.push({fileName:e,elseCount:r.length})},Nt=()=>(J.length>0&&(console.log(`
${H}else conditions${$} are used in ${J.length} files.`),console.log(`ðŸ‘‰ ${N}Try to rewrite the conditions in a way that the else clause is not necessary.${v}`),J.forEach(n=>{console.log(`- ${n.fileName} ${H}(${n.elseCount})${$}`)})),J.length),vt=5,Ft=10,k=[],Lt=(n,e)=>{const s=/\bif\b/gi,r=/\belse\b/gi,l=/\bfor\b/gi,f=/\bwhile\b/gi,d=/\bcase\b/gi,m=n.content.match(s),E=n.content.match(r),j=n.content.match(l),A=n.content.match(f),I=n.content.match(d),q=(m?.length||0)+(E?.length||0)+(j?.length||0)+(A?.length||0)+(I?.length||0);q>vt&&k.push({fileName:e,cyclomaticComplexity:q})},Rt=()=>(k.length>0&&(console.log(`
${Ae}cyclomaticComplexity${$} is above moderate in ${k.length} files.`),console.log(`ðŸ‘‰ ${N}Try to reduce complexity.${v}`),k.forEach(n=>{console.log(`- ${n.fileName} ${n.cyclomaticComplexity>Ft?S:H}(${n.cyclomaticComplexity})${$}`)})),k.length),ee=[],Wt=n=>{if(n.includes("pages"))return;const e=O.basename(n);if(e==="App.vue")return;const s=/[A-Z]/;e.slice(1).match(s)?.length||ee.push({filePath:n})},Pt=()=>(ee.length>0&&(console.log(`
${S}single name component${$} is used in ${ee.length} files.`),console.log(`ðŸ‘‰ ${N}Rename the component to use multi-word name.${v} See: https://vuejs.org/style-guide/rules-essential.html#use-multi-word-component-names`),ee.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),ee.length),te=[],Tt=(n,e)=>{n.scoped||te.push({filePath:e})},Bt=()=>(te.length>0&&(console.log(`
${S}Global style ${$} is used in ${te.length} files.`),console.log(`ðŸ‘‰ ${N}Use <style scoped>.${v} See: https://vuejs.org/style-guide/rules-essential.html#use-component-scoped-styling`),te.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),te.length),ne=[],It=(n,e)=>{const s=/defineProps\(\[/gi;n.content.match(s)?.length&&ne.push({filePath:e})},zt=()=>(ne.length>0&&(console.log(`
${S}simple prop${$} is used in ${ne.length} files.`),console.log(`ðŸ‘‰ ${N}Add at least type definition.${v} See: https://vuejs.org/style-guide/rules-essential.html#use-detailed-prop-definitions`),ne.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),ne.length),se=[],Mt=(n,e)=>{const s=/<[^>]+ v-if[^>]+ v-for[^>]+>/gi,r=/<[^>]+ v-for[^>]+ v-if[^>]+>/gi,l=n.content.match(s),f=n.content.match(r);(l?.length||f?.length)&&se.push({filePath:e})},qt=()=>(se.length>0&&(console.log(`
${S}v-if used with v-for${$} in ${se.length} files.`),console.log(`ðŸ‘‰ ${N}Move out the v-if to a computed property.${v} See: https://vuejs.org/style-guide/rules-essential.html#avoid-v-if-with-v-for`),se.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),se.length),oe=[],Ut=(n,e)=>{const s=/<[^>]+ v-for[^>]+>/gi,r=n.content.match(s);r?.length&&(r.some(f=>f.includes(":key"))||oe.push({filePath:e}))},Gt=()=>(oe.length>0&&(console.log(`
${S}v-for has no key${$} in ${oe.length} files.`),console.log(`ðŸ‘‰ ${N}Add a \`:key\` property to all v-for.${v} See: https://vuejs.org/style-guide/rules-essential.html#use-keyed-v-for`),oe.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),oe.length),ie=[],Vt=n=>{const e=O.basename(n),s=/^[A-Z][a-zA-Z0-9]+(?:(?<!^)(?=[A-Z]))*.vue$/,r=e.match(s),l=/^([a-z0-9]+-)+[a-z0-9]+\.vue$/,f=e.match(l);!r?.length&&!f?.length&&ie.push({fileName:n})},Dt=()=>(ie.length>0&&(console.log(`
${S}component name is not PascalCase and not kebab-abse${$} in ${ie.length} files.`),console.log(`ðŸ‘‰ ${N}Rename the component to use PascalCase or kebab-case file name.${v} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#single-file-component-filename-casing`),ie.forEach(n=>{console.log(`- ${S}${n.fileName}${$}`)})),ie.length),re=[],Kt=/^[a-z]+([A-Z][a-z]*)+$/,Qt=(n,e)=>{const s=/defineProps\({([^}]+)/g;let r;for(;(r=s.exec(n.content))!==null;)r[1].replace(/\s+/g,"").replace(/["']/g,"").split(",").map(f=>f.split(":")[0]).filter(f=>f.length).filter(f=>!Kt.test(f)).length&&re.push({filePath:e})},Yt=()=>(re.length>0&&(console.log(`
${S}prop names are not camelCased${$} in ${re.length} files.`),console.log(`ðŸ‘‰ ${N}Rename the props to camelCase.${v} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#prop-name-casing`),re.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),re.length),G=[],Ht=40,Zt=(n,e)=>{const s=/{{\s*([\s\S]*?)\s*}}/g;[...n.content.matchAll(s)].map(l=>l[1].trim()).forEach(l=>{l.length>Ht&&(G.some(f=>f.filePath===e)||G.push({filePath:e}))})},Xt=()=>(G.length>0&&(console.log(`
${S}Lengthy template expression${$} found in ${G.length} files.`),console.log(`ðŸ‘‰ ${N}Refactor the expression into a computed property.${v} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#simple-expressions-in-templates`),G.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),G.length);let Me=0;const qe=(n,e)=>{const s=P.readdirSync(n);Me+=s.length;for(const r of s){const l=O.join(n,r);P.statSync(l).isDirectory()?qe(l,e):r.endsWith(".vue")&&e(l)}},Jt=n=>{console.log(`

${Ae}Analyzing Vue files in ${n}${$}`);let e=0;qe(n,s=>{const r=P.readFileSync(s,"utf-8"),{descriptor:l}=He.parse(r);Wt(s),Vt(s),l.script&&Ct(s);const f=l.scriptSetup||l.script;f&&(It(f,s),Qt(f,s),Ot(f,s),Lt(f,s),St(f,s)),l.styles.forEach(d=>{Tt(d,s)}),l.template&&(Ut(l.template,s),Mt(l.template,s),Zt(l.template,s))}),console.log(`Found ${Ae}${Me}${$} Vue files`),e+=Pt(),e+=zt(),e+=Gt(),e+=qt(),e+=Bt(),e+=Dt(),e+=Yt(),e+=Xt(),e+=xt(),e+=jt(),e+=Rt(),e+=Nt(),e||console.log(`${wt}No code smells detected!${$}`)};F(Je(process.argv)).command("analyze [path]","Analyze Vue files for code smells",n=>n.positional("path",{describe:"path to the Vue files",type:"string",default:"./src"}),n=>{Jt(n.path)}).help().argv});
