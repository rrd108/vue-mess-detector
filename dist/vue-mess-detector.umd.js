(function(I,ne){typeof exports=="object"&&typeof module<"u"?ne(require("yargs"),require("util"),require("path"),require("fs"),require("assert"),require("url"),require("node:fs/promises"),require("node:path"),require("@vue/compiler-sfc")):typeof define=="function"&&define.amd?define(["yargs","util","path","fs","assert","url","node:fs/promises","node:path","@vue/compiler-sfc"],ne):(I=typeof globalThis<"u"?globalThis:I||self,ne(I.yargs,I.util,I.path,I.fs,I.assert,I.url,I["node:fs/promises"],I["node:path"],I.compilerSfc))})(this,function(I,ne,M,se,gt,Zt,Se,Ce,Xt){"use strict";var $t=typeof document<"u"?document.currentScript:null;class ae extends Error{constructor(t){super(t||"yargs error"),this.name="YError",Error.captureStackTrace&&Error.captureStackTrace(this,ae)}}function bt(){return Yt()?0:1}function Yt(){return Jt()&&!process.defaultApp}function Jt(){return!!process.versions.electron}function en(e){return e.slice(bt()+1)}function tn(){return process.argv[bt()]}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function le(e){if(e!==e.toLowerCase()&&e!==e.toUpperCase()||(e=e.toLowerCase()),e.indexOf("-")===-1&&e.indexOf("_")===-1)return e;{let n="",s=!1;const o=e.match(/^-+/);for(let c=o?o[0].length:0;c<e.length;c++){let l=e.charAt(c);s&&(s=!1,l=l.toUpperCase()),c!==0&&(l==="-"||l==="_")?s=!0:l!=="-"&&l!=="_"&&(n+=l)}return n}}function yt(e,t){const n=e.toLowerCase();t=t||"-";let s="";for(let o=0;o<e.length;o++){const c=n.charAt(o),l=e.charAt(o);c!==l&&o>0?s+=`${t}${n.charAt(o)}`:s+=l}return s}function Et(e){return e==null?!1:typeof e=="number"||/^0x[0-9a-f]+$/i.test(e)?!0:/^0[^.]/.test(e)?!1:/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e)}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function nn(e){if(Array.isArray(e))return e.map(l=>typeof l!="string"?l+"":l);e=e.trim();let t=0,n=null,s=null,o=null;const c=[];for(let l=0;l<e.length;l++){if(n=s,s=e.charAt(l),s===" "&&!o){n!==" "&&t++;continue}s===o?o=null:(s==="'"||s==='"')&&!o&&(o=s),c[t]||(c[t]=""),c[t]+=s}return c}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var K;(function(e){e.BOOLEAN="boolean",e.STRING="string",e.NUMBER="number",e.ARRAY="array"})(K||(K={}));/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */let J;class sn{constructor(t){J=t}parse(t,n){const s=Object.assign({alias:void 0,array:void 0,boolean:void 0,config:void 0,configObjects:void 0,configuration:void 0,coerce:void 0,count:void 0,default:void 0,envPrefix:void 0,narg:void 0,normalize:void 0,string:void 0,number:void 0,__:void 0,key:void 0},n),o=nn(t),c=typeof t=="string",l=on(Object.assign(Object.create(null),s.alias)),f=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"parse-positional-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},s.configuration),$=Object.assign(Object.create(null),s.default),A=s.configObjects||[],O=s.envPrefix,P=f["populate--"],T=P?"--":"_",ie=Object.create(null),Vt=Object.create(null),re=s.__||J.format,h={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},Y=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,ht=new RegExp("^--"+f["negation-prefix"]+"(.+)");[].concat(s.array||[]).filter(Boolean).forEach(function(r){const a=typeof r=="object"?r.key:r,m=Object.keys(r).map(function(u){return{boolean:"bools",string:"strings",number:"numbers"}[u]}).filter(Boolean).pop();m&&(h[m][a]=!0),h.arrays[a]=!0,h.keys.push(a)}),[].concat(s.boolean||[]).filter(Boolean).forEach(function(r){h.bools[r]=!0,h.keys.push(r)}),[].concat(s.string||[]).filter(Boolean).forEach(function(r){h.strings[r]=!0,h.keys.push(r)}),[].concat(s.number||[]).filter(Boolean).forEach(function(r){h.numbers[r]=!0,h.keys.push(r)}),[].concat(s.count||[]).filter(Boolean).forEach(function(r){h.counts[r]=!0,h.keys.push(r)}),[].concat(s.normalize||[]).filter(Boolean).forEach(function(r){h.normalize[r]=!0,h.keys.push(r)}),typeof s.narg=="object"&&Object.entries(s.narg).forEach(([r,a])=>{typeof a=="number"&&(h.nargs[r]=a,h.keys.push(r))}),typeof s.coerce=="object"&&Object.entries(s.coerce).forEach(([r,a])=>{typeof a=="function"&&(h.coercions[r]=a,h.keys.push(r))}),typeof s.config<"u"&&(Array.isArray(s.config)||typeof s.config=="string"?[].concat(s.config).filter(Boolean).forEach(function(r){h.configs[r]=!0}):typeof s.config=="object"&&Object.entries(s.config).forEach(([r,a])=>{(typeof a=="boolean"||typeof a=="function")&&(h.configs[r]=a)})),bo(s.key,l,s.default,h.arrays),Object.keys($).forEach(function(r){(h.aliases[r]||[]).forEach(function(a){$[a]=$[r]})});let Q=null;xo();let Ee=[];const F=Object.assign(Object.create(null),{_:[]}),qt={};for(let r=0;r<o.length;r++){const a=o[r],m=a.replace(/^-{3,}/,"---");let u,i,g,d,b,L;if(a!=="--"&&/^-/.test(a)&&xe(a))mt(a);else if(m.match(/^---+(=|$)/)){mt(a);continue}else if(a.match(/^--.+=/)||!f["short-option-groups"]&&a.match(/^-.+=/))d=a.match(/^--?([^=]+)=([\s\S]*)$/),d!==null&&Array.isArray(d)&&d.length>=3&&(v(d[1],h.arrays)?r=we(r,d[1],o,d[2]):v(d[1],h.nargs)!==!1?r=ve(r,d[1],o,d[2]):N(d[1],d[2],!0));else if(a.match(ht)&&f["boolean-negation"])d=a.match(ht),d!==null&&Array.isArray(d)&&d.length>=2&&(i=d[1],N(i,v(i,h.arrays)?[!1]:!1));else if(a.match(/^--.+/)||!f["short-option-groups"]&&a.match(/^-[^-]+/))d=a.match(/^--?(.+)/),d!==null&&Array.isArray(d)&&d.length>=2&&(i=d[1],v(i,h.arrays)?r=we(r,i,o):v(i,h.nargs)!==!1?r=ve(r,i,o):(b=o[r+1],b!==void 0&&(!b.match(/^-/)||b.match(Y))&&!v(i,h.bools)&&!v(i,h.counts)||/^(true|false)$/.test(b)?(N(i,b),r++):N(i,ce(i))));else if(a.match(/^-.\..+=/))d=a.match(/^-([^=]+)=([\s\S]*)$/),d!==null&&Array.isArray(d)&&d.length>=3&&N(d[1],d[2]);else if(a.match(/^-.\..+/)&&!a.match(Y))b=o[r+1],d=a.match(/^-(.\..+)/),d!==null&&Array.isArray(d)&&d.length>=2&&(i=d[1],b!==void 0&&!b.match(/^-/)&&!v(i,h.bools)&&!v(i,h.counts)?(N(i,b),r++):N(i,ce(i)));else if(a.match(/^-[^-]+/)&&!a.match(Y)){g=a.slice(1,-1).split(""),u=!1;for(let W=0;W<g.length;W++){if(b=a.slice(W+2),g[W+1]&&g[W+1]==="="){L=a.slice(W+3),i=g[W],v(i,h.arrays)?r=we(r,i,o,L):v(i,h.nargs)!==!1?r=ve(r,i,o,L):N(i,L),u=!0;break}if(b==="-"){N(g[W],b);continue}if(/[A-Za-z]/.test(g[W])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(b)&&v(b,h.bools)===!1){N(g[W],b),u=!0;break}if(g[W+1]&&g[W+1].match(/\W/)){N(g[W],b),u=!0;break}else N(g[W],ce(g[W]))}i=a.slice(-1)[0],!u&&i!=="-"&&(v(i,h.arrays)?r=we(r,i,o):v(i,h.nargs)!==!1?r=ve(r,i,o):(b=o[r+1],b!==void 0&&(!/^(-|--)[^-]/.test(b)||b.match(Y))&&!v(i,h.bools)&&!v(i,h.counts)||/^(true|false)$/.test(b)?(N(i,b),r++):N(i,ce(i))))}else if(a.match(/^-[0-9]$/)&&a.match(Y)&&v(a.slice(1),h.bools))i=a.slice(1),N(i,ce(i));else if(a==="--"){Ee=o.slice(r+1);break}else if(f["halt-at-non-option"]){Ee=o.slice(r);break}else mt(a)}Kt(F,!0),Kt(F,!1),mo(F),po(),Ht(F,h.aliases,$,!0),go(F),f["set-placeholder-key"]&&$o(F),Object.keys(h.counts).forEach(function(r){me(F,r.split("."))||N(r,0)}),P&&Ee.length&&(F[T]=[]),Ee.forEach(function(r){F[T].push(r)}),f["camel-case-expansion"]&&f["strip-dashed"]&&Object.keys(F).filter(r=>r!=="--"&&r.includes("-")).forEach(r=>{delete F[r]}),f["strip-aliased"]&&[].concat(...Object.keys(l).map(r=>l[r])).forEach(r=>{f["camel-case-expansion"]&&r.includes("-")&&delete F[r.split(".").map(a=>le(a)).join(".")],delete F[r]});function mt(r){const a=Ae("_",r);(typeof a=="string"||typeof a=="number")&&F._.push(a)}function ve(r,a,m,u){let i,g=v(a,h.nargs);if(g=typeof g!="number"||isNaN(g)?1:g,g===0)return ee(u)||(Q=Error(re("Argument unexpected for: %s",a))),N(a,ce(a)),r;let d=ee(u)?0:1;if(f["nargs-eats-options"])m.length-(r+1)+d<g&&(Q=Error(re("Not enough arguments following: %s",a))),d=g;else{for(i=r+1;i<m.length&&(!m[i].match(/^-[^0-9]/)||m[i].match(Y)||xe(m[i]));i++)d++;d<g&&(Q=Error(re("Not enough arguments following: %s",a)))}let b=Math.min(d,g);for(!ee(u)&&b>0&&(N(a,u),b--),i=r+1;i<b+r+1;i++)N(a,m[i]);return r+b}function we(r,a,m,u){let i=[],g=u||m[r+1];const d=v(a,h.nargs);if(v(a,h.bools)&&!/^(true|false)$/.test(g))i.push(!0);else if(ee(g)||ee(u)&&/^-/.test(g)&&!Y.test(g)&&!xe(g)){if($[a]!==void 0){const b=$[a];i=Array.isArray(b)?b:[b]}}else{ee(u)||i.push(pt(a,u,!0));for(let b=r+1;b<m.length&&!(!f["greedy-arrays"]&&i.length>0||d&&typeof d=="number"&&i.length>=d||(g=m[b],/^-/.test(g)&&!Y.test(g)&&!xe(g)));b++)r=b,i.push(pt(a,g,c))}return typeof d=="number"&&(d&&i.length<d||isNaN(d)&&i.length===0)&&(Q=Error(re("Not enough arguments following: %s",a))),N(a,i),r}function N(r,a,m=c){if(/-/.test(r)&&f["camel-case-expansion"]){const g=r.split(".").map(function(d){return le(d)}).join(".");Gt(r,g)}const u=pt(r,a,m),i=r.split(".");pe(F,i,u),h.aliases[r]&&h.aliases[r].forEach(function(g){const d=g.split(".");pe(F,d,u)}),i.length>1&&f["dot-notation"]&&(h.aliases[i[0]]||[]).forEach(function(g){let d=g.split(".");const b=[].concat(i);b.shift(),d=d.concat(b),(h.aliases[r]||[]).includes(d.join("."))||pe(F,d,u)}),v(r,h.normalize)&&!v(r,h.arrays)&&[r].concat(h.aliases[r]||[]).forEach(function(d){Object.defineProperty(qt,d,{enumerable:!0,get(){return a},set(b){a=typeof b=="string"?J.normalize(b):b}})})}function Gt(r,a){h.aliases[r]&&h.aliases[r].length||(h.aliases[r]=[a],ie[a]=!0),h.aliases[a]&&h.aliases[a].length||Gt(a,r)}function pt(r,a,m){m&&(a=rn(a)),(v(r,h.bools)||v(r,h.counts))&&typeof a=="string"&&(a=a==="true");let u=Array.isArray(a)?a.map(function(i){return Ae(r,i)}):Ae(r,a);return v(r,h.counts)&&(ee(u)||typeof u=="boolean")&&(u=Oe()),v(r,h.normalize)&&v(r,h.arrays)&&(Array.isArray(a)?u=a.map(i=>J.normalize(i)):u=J.normalize(a)),u}function Ae(r,a){return!f["parse-positional-numbers"]&&r==="_"||!v(r,h.strings)&&!v(r,h.bools)&&!Array.isArray(a)&&(Et(a)&&f["parse-numbers"]&&Number.isSafeInteger(Math.floor(parseFloat(`${a}`)))||!ee(a)&&v(r,h.numbers))&&(a=Number(a)),a}function mo(r){const a=Object.create(null);Ht(a,h.aliases,$),Object.keys(h.configs).forEach(function(m){const u=r[m]||a[m];if(u)try{let i=null;const g=J.resolve(J.cwd(),u),d=h.configs[m];if(typeof d=="function"){try{i=d(g)}catch(b){i=b}if(i instanceof Error){Q=i;return}}else i=J.require(g);dt(i)}catch(i){i.name==="PermissionDenied"?Q=i:r[m]&&(Q=Error(re("Invalid JSON config file: %s",u)))}})}function dt(r,a){Object.keys(r).forEach(function(m){const u=r[m],i=a?a+"."+m:m;typeof u=="object"&&u!==null&&!Array.isArray(u)&&f["dot-notation"]?dt(u,i):(!me(F,i.split("."))||v(i,h.arrays)&&f["combine-arrays"])&&N(i,u)})}function po(){typeof A<"u"&&A.forEach(function(r){dt(r)})}function Kt(r,a){if(typeof O>"u")return;const m=typeof O=="string"?O:"",u=J.env();Object.keys(u).forEach(function(i){if(m===""||i.lastIndexOf(m,0)===0){const g=i.split("__").map(function(d,b){return b===0&&(d=d.substring(m.length)),le(d)});(a&&h.configs[g.join(".")]||!a)&&!me(r,g)&&N(g.join("."),u[i])}})}function go(r){let a;const m=new Set;Object.keys(r).forEach(function(u){if(!m.has(u)&&(a=v(u,h.coercions),typeof a=="function"))try{const i=Ae(u,a(r[u]));[].concat(h.aliases[u]||[],u).forEach(g=>{m.add(g),r[g]=i})}catch(i){Q=i}})}function $o(r){return h.keys.forEach(a=>{~a.indexOf(".")||typeof r[a]>"u"&&(r[a]=void 0)}),r}function Ht(r,a,m,u=!1){Object.keys(m).forEach(function(i){me(r,i.split("."))||(pe(r,i.split("."),m[i]),u&&(Vt[i]=!0),(a[i]||[]).forEach(function(g){me(r,g.split("."))||pe(r,g.split("."),m[i])}))})}function me(r,a){let m=r;f["dot-notation"]||(a=[a.join(".")]),a.slice(0,-1).forEach(function(i){m=m[i]||{}});const u=a[a.length-1];return typeof m!="object"?!1:u in m}function pe(r,a,m){let u=r;f["dot-notation"]||(a=[a.join(".")]),a.slice(0,-1).forEach(function(L){L=vt(L),typeof u=="object"&&u[L]===void 0&&(u[L]={}),typeof u[L]!="object"||Array.isArray(u[L])?(Array.isArray(u[L])?u[L].push({}):u[L]=[u[L],{}],u=u[L][u[L].length-1]):u=u[L]});const i=vt(a[a.length-1]),g=v(a.join("."),h.arrays),d=Array.isArray(m);let b=f["duplicate-arguments-array"];!b&&v(i,h.nargs)&&(b=!0,(!ee(u[i])&&h.nargs[i]===1||Array.isArray(u[i])&&u[i].length===h.nargs[i])&&(u[i]=void 0)),m===Oe()?u[i]=Oe(u[i]):Array.isArray(u[i])?b&&g&&d?u[i]=f["flatten-duplicate-arrays"]?u[i].concat(m):(Array.isArray(u[i][0])?u[i]:[u[i]]).concat([m]):!b&&!!g==!!d?u[i]=m:u[i]=u[i].concat([m]):u[i]===void 0&&g?u[i]=d?m:[m]:b&&!(u[i]===void 0||v(i,h.counts)||v(i,h.bools))?u[i]=[u[i],m]:u[i]=m}function bo(...r){r.forEach(function(a){Object.keys(a||{}).forEach(function(m){h.aliases[m]||(h.aliases[m]=[].concat(l[m]||[]),h.aliases[m].concat(m).forEach(function(u){if(/-/.test(u)&&f["camel-case-expansion"]){const i=le(u);i!==m&&h.aliases[m].indexOf(i)===-1&&(h.aliases[m].push(i),ie[i]=!0)}}),h.aliases[m].concat(m).forEach(function(u){if(u.length>1&&/[A-Z]/.test(u)&&f["camel-case-expansion"]){const i=yt(u,"-");i!==m&&h.aliases[m].indexOf(i)===-1&&(h.aliases[m].push(i),ie[i]=!0)}}),h.aliases[m].forEach(function(u){h.aliases[u]=[m].concat(h.aliases[m].filter(function(i){return u!==i}))}))})})}function v(r,a){const m=[].concat(h.aliases[r]||[],r),u=Object.keys(a),i=m.find(g=>u.includes(g));return i?a[i]:!1}function Qt(r){const a=Object.keys(h);return[].concat(a.map(u=>h[u])).some(function(u){return Array.isArray(u)?u.includes(r):u[r]})}function yo(r,...a){return[].concat(...a).some(function(u){const i=r.match(u);return i&&Qt(i[1])})}function Eo(r){if(r.match(Y)||!r.match(/^-[^-]+/))return!1;let a=!0,m;const u=r.slice(1).split("");for(let i=0;i<u.length;i++){if(m=r.slice(i+2),!Qt(u[i])){a=!1;break}if(u[i+1]&&u[i+1]==="="||m==="-"||/[A-Za-z]/.test(u[i])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(m)||u[i+1]&&u[i+1].match(/\W/))break}return a}function xe(r){return f["unknown-options-as-args"]&&vo(r)}function vo(r){return r=r.replace(/^-{3,}/,"--"),r.match(Y)||Eo(r)?!1:!yo(r,/^-+([^=]+?)=[\s\S]*$/,ht,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}function ce(r){return!v(r,h.bools)&&!v(r,h.counts)&&`${r}`in $?$[r]:wo(Ao(r))}function wo(r){return{[K.BOOLEAN]:!0,[K.STRING]:"",[K.NUMBER]:void 0,[K.ARRAY]:[]}[r]}function Ao(r){let a=K.BOOLEAN;return v(r,h.strings)?a=K.STRING:v(r,h.numbers)?a=K.NUMBER:v(r,h.bools)?a=K.BOOLEAN:v(r,h.arrays)&&(a=K.ARRAY),a}function ee(r){return r===void 0}function xo(){Object.keys(h.counts).find(r=>v(r,h.arrays)?(Q=Error(re("Invalid configuration: %s, opts.count excludes opts.array.",r)),!0):v(r,h.nargs)?(Q=Error(re("Invalid configuration: %s, opts.count excludes opts.narg.",r)),!0):!1)}return{aliases:Object.assign({},h.aliases),argv:Object.assign(qt,F),configuration:f,defaulted:Object.assign({},Vt),error:Q,newAliases:Object.assign({},ie)}}}function on(e){const t=[],n=Object.create(null);let s=!0;for(Object.keys(e).forEach(function(o){t.push([].concat(e[o],o))});s;){s=!1;for(let o=0;o<t.length;o++)for(let c=o+1;c<t.length;c++)if(t[o].filter(function(f){return t[c].indexOf(f)!==-1}).length){t[o]=t[o].concat(t[c]),t.splice(c,1),s=!0;break}}return t.forEach(function(o){o=o.filter(function(l,f,$){return $.indexOf(l)===f});const c=o.pop();c!==void 0&&typeof c=="string"&&(n[c]=o)}),n}function Oe(e){return e!==void 0?e+1:1}function vt(e){return e==="__proto__"?"___proto___":e}function rn(e){return typeof e=="string"&&(e[0]==="'"||e[0]==='"')&&e[e.length-1]===e[0]?e.substring(1,e.length-1):e}/**
 * @fileoverview Main entrypoint for libraries using yargs-parser in Node.js
 * CJS and ESM environments.
 *
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var _e,Ne,Re;const wt=process&&process.env&&process.env.YARGS_MIN_NODE_VERSION?Number(process.env.YARGS_MIN_NODE_VERSION):12,At=(Ne=(_e=process==null?void 0:process.versions)===null||_e===void 0?void 0:_e.node)!==null&&Ne!==void 0?Ne:(Re=process==null?void 0:process.version)===null||Re===void 0?void 0:Re.slice(1);if(At&&Number(At.match(/^([^.]+)/)[1])<wt)throw Error(`yargs parser supports a minimum Node.js version of ${wt}. Read our version support policy: https://github.com/yargs/yargs-parser#supported-nodejs-versions`);const cn=process?process.env:{},xt=new sn({cwd:process.cwd,env:()=>cn,format:ne.format,normalize:M.normalize,resolve:M.resolve,require:e=>{if(typeof require<"u")return require(e);if(e.match(/\.json$/))return JSON.parse(se.readFileSync(e,"utf8"));throw Error("only .json config files are supported in ESM")}}),ue=function(t,n){return xt.parse(t.slice(),n).argv};ue.detailed=function(e,t){return xt.parse(e.slice(),t)},ue.camelCase=le,ue.decamelize=yt,ue.looksLikeNumber=Et;const an={right:pn,center:dn},ln=0,de=1,un=2,ge=3;class fn{constructor(t){var n;this.width=t.width,this.wrap=(n=t.wrap)!==null&&n!==void 0?n:!0,this.rows=[]}span(...t){const n=this.div(...t);n.span=!0}resetOutput(){this.rows=[]}div(...t){if(t.length===0&&this.div(""),this.wrap&&this.shouldApplyLayoutDSL(...t)&&typeof t[0]=="string")return this.applyLayoutDSL(t[0]);const n=t.map(s=>typeof s=="string"?this.colFromString(s):s);return this.rows.push(n),n}shouldApplyLayoutDSL(...t){return t.length===1&&typeof t[0]=="string"&&/[\t\n]/.test(t[0])}applyLayoutDSL(t){const n=t.split(`
`).map(o=>o.split("	"));let s=0;return n.forEach(o=>{o.length>1&&B.stringWidth(o[0])>s&&(s=Math.min(Math.floor(this.width*.5),B.stringWidth(o[0])))}),n.forEach(o=>{this.div(...o.map((c,l)=>({text:c.trim(),padding:this.measurePadding(c),width:l===0&&o.length>1?s:void 0})))}),this.rows[this.rows.length-1]}colFromString(t){return{text:t,padding:this.measurePadding(t)}}measurePadding(t){const n=B.stripAnsi(t);return[0,n.match(/\s*$/)[0].length,0,n.match(/^\s*/)[0].length]}toString(){const t=[];return this.rows.forEach(n=>{this.rowToString(n,t)}),t.filter(n=>!n.hidden).map(n=>n.text).join(`
`)}rowToString(t,n){return this.rasterize(t).forEach((s,o)=>{let c="";s.forEach((l,f)=>{const{width:$}=t[f],A=this.negatePadding(t[f]);let O=l;if(A>B.stringWidth(l)&&(O+=" ".repeat(A-B.stringWidth(l))),t[f].align&&t[f].align!=="left"&&this.wrap){const T=an[t[f].align];O=T(O,A),B.stringWidth(O)<A&&(O+=" ".repeat(($||0)-B.stringWidth(O)-1))}const P=t[f].padding||[0,0,0,0];P[ge]&&(c+=" ".repeat(P[ge])),c+=St(t[f],O,"| "),c+=O,c+=St(t[f],O," |"),P[de]&&(c+=" ".repeat(P[de])),o===0&&n.length>0&&(c=this.renderInline(c,n[n.length-1]))}),n.push({text:c.replace(/ +$/,""),span:t.span})}),n}renderInline(t,n){const s=t.match(/^ */),o=s?s[0].length:0,c=n.text,l=B.stringWidth(c.trimRight());return n.span?this.wrap?o<l?t:(n.hidden=!0,c.trimRight()+" ".repeat(o-l)+t.trimLeft()):(n.hidden=!0,c+t):t}rasterize(t){const n=[],s=this.columnWidths(t);let o;return t.forEach((c,l)=>{c.width=s[l],this.wrap?o=B.wrap(c.text,this.negatePadding(c),{hard:!0}).split(`
`):o=c.text.split(`
`),c.border&&(o.unshift("."+"-".repeat(this.negatePadding(c)+2)+"."),o.push("'"+"-".repeat(this.negatePadding(c)+2)+"'")),c.padding&&(o.unshift(...new Array(c.padding[ln]||0).fill("")),o.push(...new Array(c.padding[un]||0).fill(""))),o.forEach((f,$)=>{n[$]||n.push([]);const A=n[$];for(let O=0;O<l;O++)A[O]===void 0&&A.push("");A.push(f)})}),n}negatePadding(t){let n=t.width||0;return t.padding&&(n-=(t.padding[ge]||0)+(t.padding[de]||0)),t.border&&(n-=4),n}columnWidths(t){if(!this.wrap)return t.map(l=>l.width||B.stringWidth(l.text));let n=t.length,s=this.width;const o=t.map(l=>{if(l.width)return n--,s-=l.width,l.width}),c=n?Math.floor(s/n):0;return o.map((l,f)=>l===void 0?Math.max(c,hn(t[f])):l)}}function St(e,t,n){return e.border?/[.']-+[.']/.test(t)?"":t.trim().length!==0?n:"  ":""}function hn(e){const t=e.padding||[],n=1+(t[ge]||0)+(t[de]||0);return e.border?n+4:n}function mn(){return typeof process=="object"&&process.stdout&&process.stdout.columns?process.stdout.columns:80}function pn(e,t){e=e.trim();const n=B.stringWidth(e);return n<t?" ".repeat(t-n)+e:e}function dn(e,t){e=e.trim();const n=B.stringWidth(e);return n>=t?e:" ".repeat(t-n>>1)+e}let B;function gn(e,t){return B=t,new fn({width:e?.width||mn(),wrap:e?.wrap})}const Ct=new RegExp("\x1B(?:\\[(?:\\d+[ABCDEFGJKSTm]|\\d+;\\d+[Hfm]|\\d+;\\d+;\\d+m|6n|s|u|\\?25[lh])|\\w)","g");function Ot(e){return e.replace(Ct,"")}function $n(e,t){const[n,s]=e.match(Ct)||["",""];e=Ot(e);let o="";for(let c=0;c<e.length;c++)c!==0&&c%t===0&&(o+=`
`),o+=e.charAt(c);return n&&s&&(o=`${n}${o}${s}`),o}function bn(e){return gn(e,{stringWidth:t=>[...t].length,stripAnsi:Ot,wrap:$n})}function yn(e,t){let n=M.resolve(".",e),s;for(se.statSync(n).isDirectory()||(n=M.dirname(n));;){if(s=t(n,se.readdirSync(n)),s)return M.resolve(n,s);if(n=M.dirname(s=n),s===n)break}}const En={fs:{readFileSync:se.readFileSync,writeFile:se.writeFile},format:ne.format,resolve:M.resolve,exists:e=>{try{return se.statSync(e).isFile()}catch{return!1}}};let H;class vn{constructor(t){t=t||{},this.directory=t.directory||"./locales",this.updateFiles=typeof t.updateFiles=="boolean"?t.updateFiles:!0,this.locale=t.locale||"en",this.fallbackToLanguage=typeof t.fallbackToLanguage=="boolean"?t.fallbackToLanguage:!0,this.cache=Object.create(null),this.writeQueue=[]}__(...t){if(typeof arguments[0]!="string")return this._taggedLiteral(arguments[0],...arguments);const n=t.shift();let s=function(){};return typeof t[t.length-1]=="function"&&(s=t.pop()),s=s||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][n]&&this.updateFiles?(this.cache[this.locale][n]=n,this._enqueueWrite({directory:this.directory,locale:this.locale,cb:s})):s(),H.format.apply(H.format,[this.cache[this.locale][n]||n].concat(t))}__n(){const t=Array.prototype.slice.call(arguments),n=t.shift(),s=t.shift(),o=t.shift();let c=function(){};typeof t[t.length-1]=="function"&&(c=t.pop()),this.cache[this.locale]||this._readLocaleFile();let l=o===1?n:s;this.cache[this.locale][n]&&(l=this.cache[this.locale][n][o===1?"one":"other"]),!this.cache[this.locale][n]&&this.updateFiles?(this.cache[this.locale][n]={one:n,other:s},this._enqueueWrite({directory:this.directory,locale:this.locale,cb:c})):c();const f=[l];return~l.indexOf("%d")&&f.push(o),H.format.apply(H.format,f.concat(t))}setLocale(t){this.locale=t}getLocale(){return this.locale}updateLocale(t){this.cache[this.locale]||this._readLocaleFile();for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(this.cache[this.locale][n]=t[n])}_taggedLiteral(t,...n){let s="";return t.forEach(function(o,c){const l=n[c+1];s+=o,typeof l<"u"&&(s+="%s")}),this.__.apply(this,[s].concat([].slice.call(n,1)))}_enqueueWrite(t){this.writeQueue.push(t),this.writeQueue.length===1&&this._processWriteQueue()}_processWriteQueue(){const t=this,n=this.writeQueue[0],s=n.directory,o=n.locale,c=n.cb,l=this._resolveLocaleFile(s,o),f=JSON.stringify(this.cache[o],null,2);H.fs.writeFile(l,f,"utf-8",function($){t.writeQueue.shift(),t.writeQueue.length>0&&t._processWriteQueue(),c($)})}_readLocaleFile(){let t={};const n=this._resolveLocaleFile(this.directory,this.locale);try{H.fs.readFileSync&&(t=JSON.parse(H.fs.readFileSync(n,"utf-8")))}catch(s){if(s instanceof SyntaxError&&(s.message="syntax error in "+n),s.code==="ENOENT")t={};else throw s}this.cache[this.locale]=t}_resolveLocaleFile(t,n){let s=H.resolve(t,"./",n+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(s)&&~n.lastIndexOf("_")){const o=H.resolve(t,"./",n.split("_")[0]+".json");this._fileExistsSync(o)&&(s=o)}return s}_fileExistsSync(t){return H.exists(t)}}function wn(e,t){H=t;const n=new vn(e);return{__:n.__.bind(n),__n:n.__n.bind(n),setLocale:n.setLocale.bind(n),getLocale:n.getLocale.bind(n),updateLocale:n.updateLocale.bind(n),locale:n.locale}}const An=e=>wn(e,En),xn="require is not supported by ESM",_t="loading a directory of commands is not supported yet for ESM";let fe;try{fe=Zt.fileURLToPath(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:$t&&$t.src||new URL("vue-mess-detector.umd.js",document.baseURI).href)}catch{fe=process.cwd()}const Sn=fe.substring(0,fe.lastIndexOf("node_modules"));gt.notStrictEqual,gt.strictEqual,ne.inspect,Sn||process.cwd(),M.basename,M.dirname,M.extname,M.relative,M.resolve,process.cwd,process.exit,process.nextTick,typeof process.stdout.columns<"u"&&process.stdout.columns,se.readFileSync,An({directory:M.resolve(fe,"../../../locales"),updateFiles:!1});const Z="\x1B[44m",x="\x1B[43m",D="\x1B[41m",Nt="\x1B[42m",y="\x1B[0m",w="\x1B[33m",S="\x1B[36m",p="\x1B[0m",oe=Object.keys({"vue-caution":["elementSelectorsWithScoped","implicitParentChildCommunication"],"vue-essential":["globalStyle","simpleProp","singleNameComponent","vforNoKey","vifWithVfor"],"vue-recommended":["elementAttributeOrder","topLevelElementOrder"],"vue-strong":["componentFilenameCasing","componentFiles","directiveShorthands","fullWordComponentName","multiAttributeElements","propNameCasing","quotedAttributeValues","selfClosingComponents","simpleComputed","templateSimpleExpression"],rrd:["cyclomaticComplexity","deepIndentation","elseCondition","functionSize","htmlLink","ifWithoutCurlyBraces","magicNumbers","nestedTernary","parameterCount","plainScript","propsDrilling","scriptLength","shortVariableName","tooManyProps","vForWithIndexKey"]}),je=[],Fe=100,Cn=(e,t)=>{if(!e)return;const n=e.content.split(`
`);n.length>Fe&&je.push({filePath:t,message:`${n.length>Fe*2?D:x}(${n.length} lines)${y}`})},On=()=>{const e=[];return je.length>0&&je.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ Long <script> blocks${p}`,description:`ðŸ‘‰ ${w}Try to refactor out the logic into composable functions or other files and keep the script block's length under ${Fe} lines.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/script-length.html`,message:`${t.message} ðŸš¨`})}),e},Le=[],_n=(e,t)=>{!e||e.setup||Le.push({filePath:t,message:`${x}Plain <script> block${y} found`})},Nn=()=>{const e=[];return Le.length>0&&Le.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ Plain <script> blocks${p}`,description:`ðŸ‘‰ ${w} Consider using <script setup> to leverage the new SFC <script> syntax.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/plain-script.html`,message:`${t.message} ðŸš¨`})}),e},Rn=/^(\(.*\)|\\?.)$/;function te(e){const t=e.toString();return Rn.test(t)?t:`(?:${t})`}const jn=/^(?:\(\?:(.+)\)|(\(?.+\)?))$/,Fn=/^(?:\(\?:(.+)\)([?+*]|{[\d,]+})?|(.+))$/;function E(e){const t=n=>E(`(?<${n}>${`${e}`.replace(jn,"$1$2")})`);return{toString:()=>e.toString(),and:Object.assign((...n)=>E(`${e}${q(...n)}`),{referenceTo:n=>E(`${e}\\k<${n}>`)}),or:(...n)=>E(`(?:${e}|${q(...n)})`),after:(...n)=>E(`(?<=${q(...n)})${e}`),before:(...n)=>E(`${e}(?=${q(...n)})`),notAfter:(...n)=>E(`(?<!${q(...n)})${e}`),notBefore:(...n)=>E(`${e}(?!${q(...n)})`),times:Object.assign(n=>E(`${te(e)}{${n}}`),{any:()=>E(`${te(e)}*`),atLeast:n=>E(`${te(e)}{${n},}`),atMost:n=>E(`${te(e)}{0,${n}}`),between:(n,s)=>E(`${te(e)}{${n},${s}}`)}),optionally:()=>E(`${te(e)}?`),as:t,groupedAs:t,grouped:()=>E(`${e}`.replace(Fn,"($1$3)$2")),at:{lineStart:()=>E(`^${e}`),lineEnd:()=>E(`${e}$`)}}}const Ln=/[.*+?^${}()|[\]\\/]/g;function he(e){return E(`[${e.replace(/[-\\^\]]/g,"\\$&")}]`)}function k(e){return E(`[^${e.replace(/[-\\^\]]/g,"\\$&")}]`)}function Pn(...e){return E(`(?:${e.map(t=>q(t)).join("|")})`)}const $e=E(".");E("\\b\\w+\\b");const V=E("\\w"),z=E("\\b"),Tn=E("\\d"),R=E("\\s"),Rt=Object.assign(E("[a-zA-Z]"),{lowercase:E("[a-z]"),uppercase:E("[A-Z]")}),jt=E("\\t"),Ft=E("\\n");E("\\r"),E("\\W+"),E("\\W"),E("\\B"),E("\\D"),E("\\S"),Object.assign(E("[^a-zA-Z]"),{lowercase:E("[^a-z]"),uppercase:E("[^A-Z]")}),E("[^\\t]"),E("[^\\n]"),E("[^\\r]");function X(...e){return E(`${te(q(...e))}?`)}function q(...e){return E(e.map(t=>typeof t=="string"?t.replace(Ln,"\\$&"):t).join(""))}function C(...e){return E(`${te(q(...e))}+`)}const G="i",j="g",_=(...e)=>{const t=e.length>1&&(Array.isArray(e[e.length-1])||e[e.length-1]instanceof Set)?e.pop():void 0;return new RegExp(q(...e).toString(),[...t||""].join(""))},Pe=[],Wn=(e,t)=>{if(!e)return;const n=_(z,"else",z,[j,G]),s=e.content.match(n);s?.length&&Pe.push({filePath:t,message:`else clauses found ${D}(${s.length})${y}`})},In=()=>{const e=[];return Pe.length>0&&Pe.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ else conditions${p}`,description:`ðŸ‘‰ ${w}Try to rewrite the conditions in a way that the else clause is not necessary.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/else-condition.html`,message:`${t.message} ðŸš¨`})}),e},Te=[],Mn=5,Bn=10,kn=(e,t)=>{if(!e)return;const n=_(z,"if",z,[j,G]),s=_(z,"else",z,[j,G]),o=_(z,"for",z,[j,G]),c=_(z,"while",z,[j,G]),l=_(z,"case",z,[j,G]),f=e.content.match(n),$=e.content.match(s),A=e.content.match(o),O=e.content.match(c),P=e.content.match(l),T=(f?.length||0)+($?.length||0)+(A?.length||0)+(O?.length||0)+(P?.length||0);T>Mn&&Te.push({filePath:t,message:`${T>Bn?D:x}(${T})${y}`})},zn=()=>{const e=[];return Te.length>0&&Te.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ cyclomatic complexity${p}`,description:`ðŸ‘‰ ${w}Try to reduce complexity.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/cyclomatic-complexity.html`,message:`${t.message} ðŸš¨`})}),e},We=[],Un=e=>{if(e.includes("pages"))return;const t=Ce.basename(e);if(t==="App.vue")return;const n=_(Rt.uppercase);t.slice(1).match(n)?.length||We.push({filePath:e,message:`Component name is ${x}single word${y}`})},Dn=()=>{const e=[];return We.length>0&&We.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-essential ~ single name component${p}`,description:`ðŸ‘‰ ${w}Rename the component to use multi-word name.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/single-name-component.html`,message:`${t.message} ðŸš¨`})}),e},Ie=[],Vn=(e,t)=>{e&&e.forEach(n=>{n.scoped||Ie.push({filePath:t,message:`${x}global style${y} used`})})},qn=()=>{const e=[];return Ie.length>0&&Ie.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-essential ~ global style${p}`,description:`ðŸ‘‰ ${w}Use <style scoped>.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/global-style.html`,message:`${t.message} ðŸš¨`})}),e},Me=[],Gn=(e,t)=>{if(!e)return;const n=_("defineProps([",[j,G]);e.content.match(n)?.length&&Me.push({filePath:t,message:`${x}Props type${y} not defined`})},Kn=()=>{const e=[];return Me.length>0&&Me.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-essential ~ simple prop${p}`,description:`ðŸ‘‰ ${w}Add at least type definition.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/simple-prop.html`,message:`${t.message} ðŸš¨`})}),e},U=(e,t)=>{if(!t.includes(`
`))return e.split(`
`).findIndex(l=>l.includes(t))+1;const n=e.indexOf(t),s=e.slice(0,n).split(`
`).length,o=t.split(`
`).length;return s+o-1},Be=[],Hn=(e,t)=>{if(!e)return;const n=_("<",C(k(">"))," v-if",C(k(">"))," v-for",C(k(">")),">",[j,G]),s=_("<",C(k(">"))," v-for",C(k(">"))," v-if",C(k(">")),">",[j,G]),o=e.content.match(n),c=e.content.match(s);if(o?.length||c?.length){const l=o?.length?o[0]:c?.length?c[0]:"",f=U(e.content,l);Be.push({filePath:t,message:`line #${f} ${x}v-if used with v-for${y}`})}},Qn=()=>{const e=[];return Be.length>0&&Be.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-essential ~ v-if used with v-for${p}`,description:`ðŸ‘‰ ${w}Move out the v-if to a computed property.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/vif-with-vfor.html`,message:`${t.message} ðŸš¨`})}),e},ke=[],Zn=(e,t)=>{if(!e)return;const n=_("<",C(k(">"))," v-for",C(k(">")),">",[j,G]),s=e.content.match(n);s?.length&&(s.some(c=>c.includes(":key"))||ke.push({filePath:t,message:`v-for used ${x}without a key${y}`}))},Xn=()=>{const e=[];return ke.length>0&&ke.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-essential ~ v-for has no key${p}`,description:`ðŸ‘‰ ${w}Add a \`:key\` property to all v-for.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-essential/vfor-no-key.html`,message:`${t.message} ðŸš¨`})}),e},ze=[],Yn=e=>{if(e.includes("pages")||e.includes("layouts"))return;const t=Ce.basename(e),n=/^[A-Z][a-zA-Z0-9]+(?:(?<!^)(?=[A-Z]))*.vue$/,s=t.match(n),o=/^([a-z0-9]+-)+[a-z0-9]+\.vue$/,c=t.match(o);!s?.length&&!c?.length&&ze.push({filePath:e,message:`component name is ${x}not PascalCase, nor kebab-case.${y}`})},Jn=()=>{const e=[];return ze.length>0&&ze.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ component name is not PascalCase and not kebab-case${p}`,description:`ðŸ‘‰ ${w}Rename the component to use PascalCase or kebab-case file name.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/component-filename-casing.html`,message:`${t.message} ðŸš¨`})}),e},Ue=[],es=/^[a-z]+([A-Z][a-z]*)*$/,ts=(e,t)=>{if(!e)return;const n=/defineProps\({([^}]+)/g;let s;for(;(s=n.exec(e.content))!==null;)s[1].replace(/\s+/g,"").replace(/["']/g,"").split(",").map(c=>c.split(":")[0]).filter(c=>c.length).filter(c=>!es.test(c)).length&&Ue.push({filePath:t,message:`prop names are ${x}not camelCased${y}`})},ns=()=>{const e=[];return Ue.length>0&&Ue.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ prop names are not camelCased${p}`,description:`ðŸ‘‰ ${w}Rename the props to camelCase.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/prop-name-casing.html`,message:`${t.message} ðŸš¨`})}),e},De=[],ss=40,os=(e,t)=>{if(!e)return;const n=/{{\s*([\s\S]*?)\s*}}/g;[...e.content.matchAll(n)].map(o=>o[1].trim()).forEach(o=>{if(o.length>ss){const c=U(e.content,o),l=o.split(`
`).at(0)?.trim()||"";De.push({filePath:t,message:`line #${c} ${x}${l}${y}`})}})},rs=()=>{const e=[];return De.length>0&&De.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ lengthy template expression${p}`,description:`ðŸ‘‰ ${w}Refactor the expression into a computed property.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/template-simple-expression.html`,message:`${t.message} ðŸš¨`})}),e},Ve=[],is=(e,t)=>{if(!e)return;const n=e.template,s=_("<",C(V),X(C(he(` 	
\r`))),C(k("/>")),X(C(he(` 	
\r`))),X("/"),">",["g"]),o=n?.content.match(s);if(o===null)return;const c=_(":",C(V),X(" "),"=",X(" "),k(`'"`),["g"]);o?.forEach(l=>{if(!l.includes(":"))return;const f=l.match(c);if(f?.length){const $=U(e.source,l);Ve.push({filePath:t,message:`line #${$} ${x}${f}${y}`})}})},cs=()=>{const e=[];return Ve.length>0&&Ve.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ attribute value is not quoted${p}`,description:`ðŸ‘‰ ${w}Use quotes for attribute values.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/quoted-attribute-values.html`,message:`${t.message} ðŸš¨`})}),e},qe=[],as=(e,t)=>{if(!e)return;const n=e.template,s=_("<",C(Rt.uppercase,V),X(Ft,jt),X(C(k(">"))),"></",C(V),">",["g"]),o=n?.content?.match(s);o!==null&&o?.forEach(c=>{const l=U(e.source,c),f=c.split(`
`).at(-1)?.trim()||"";qe.push({filePath:t,message:`line #${l} ${x}${f}${y}`})})},ls=()=>{const e=[];return qe.length>0&&qe.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ component is not self closing${p}`,description:`ðŸ‘‰ ${w}Components with no content should be self-closing.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/self-closing-components.html`,message:`${t.message} ðŸš¨`})}),e},Ge=[],Lt=[],us=["v-slot","v-bind","v-on"],fs=(e,t)=>{if(!e)return;const n=e.template;us.forEach(s=>{if(n?.content.includes(`${s}:`)){const o=U(e.source,s);Ge.push({filePath:t,message:`line #${o} ${x}${s}${y}`}),Lt.some(c=>c.filePath===t)||Lt.push({filePath:t})}})},hs=()=>{const e=[];return Ge.length>0&&Ge.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ directive shorthands not used${p}`,description:`ðŸ‘‰ ${w}Use ":" for v-bind:, "@" for v-on: and "#" for v-slot.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/directive-shorthands.html`,message:`${t.message} ðŸš¨`})}),e},Ke=[],ms=3,ps=e=>{const t=_(C(k("/")).grouped(),q(".vue").at.lineEnd()),n=e.match(t);if(n){const s=n[0]?.split(".vue")[0],o=_(he("bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ"),[j]),c=s.match(o);(!c||c.length<ms)&&Ke.push({filePath:e,message:`${s} is not a ${x}full word.${y}`})}},ds=()=>{const e=[];return Ke.length>0&&Ke.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ full-word component names${p}`,description:`ðŸ‘‰ ${w}Component names should prefer full words over abbreviations.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/full-word-component-name.html`,message:`${t.message} ðŸš¨`})}),e},He=[],gs=(e,t)=>{const n=e.toString(),s=n.indexOf("<script setup>"),o=n.indexOf("<template>"),c=n.indexOf("<style>"),l=[{name:"script",index:s},{name:"template",index:o},{name:"style",index:c}].filter($=>$.index!==-1);l.every(($,A)=>A===0?!0:l[A-1].index<$.index)||He.push({filePath:t,message:`Top level elements are ${x}not following the correct order.${y}`})},$s=()=>{const e=[];return He.length>0&&He.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-recommended ~ top level element order${p}`,description:`ðŸ‘‰ ${w}Single-File Components should always order <script>, <template>, and <style> tags consistently.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-recommended/top-level-element-order.html`,message:`${t.message} ðŸš¨`})}),e},Qe=[],Pt=["is","v-for","v-if","v-else-if","v-else","v-show","v-cloak","v-pre","v-once","id","ref","key","v-model","v-on","v-html","v-text"],bs=(e,t)=>{if(!e)return;const n=e.content.replace(/<\/?template>/g,""),s=/<(\w+)(\s[^>]+)?>/g,o=/(\w+(?:-\w+)*)(?:="[^"]*")?/g;let c;for(;(c=s.exec(n))!==null;){const l=c[1],f=c[2];if(f){const A=Array.from(f.matchAll(o),P=>P[1]).filter(P=>Pt.includes(P));let O=-1;for(const P of A){const T=Pt.indexOf(P);if(T!==-1&&T<O){Qe.push({filePath:t,message:`tag has attributes out of order ${x}(${l})${y}`});break}O=T}}}},ys=()=>{const e=[];return Qe.length>0&&Qe.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-recommended ~ element attribute order${p}`,description:`ðŸ‘‰ ${w}The attributes of elements (including components) should be ordered consistently.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-recommended/element-attribute-order.html`,message:`${t.message} ðŸš¨`})}),e},Ze=[],Es=5,vs=(e,t)=>{if(!e)return;const n=_("defineProps",X("<"),X("("),"{",C($e),"}",["g","s"]),s=e.content.match(n);if(s?.length){const o=s[0].split(",").length;o>Es&&Ze.push({filePath:t,message:`props found ${D}(${o})${y}`})}},ws=()=>{const e=[];return Ze.length>0&&Ze.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ too many props${p}`,description:`ðŸ‘‰ ${w}Try to refactor your code to use less properties.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/too-many-props.html`,message:`${t.message} ðŸš¨`})}),e},Xe=[],Tt=20;function As(e,t,n){t.split(`
`).length>Tt&&Xe.push({filePath:n,message:`function ${D}(${_s(e)})${y} is too long`})}function xs(e,t){let n="",s=t;for(;s<e.length&&/\s/.test(e[s]);)s++;if(e.slice(s,s+5)==="const")for(s+=5;s<e.length&&/\s/.test(e[s]);)s++;for(;s<e.length&&/[\w$]/.test(e[s]);)n+=e[s],s++;return n.trim()}function Ss(e,t){let n=t;for(;n<e.length&&e[n]!=="{";)n++;return n+1}function Cs(e,t){let n="",s=-1;for(;t<e.length&&e[t]!=="=";)/\w/.test(e[t])&&(n+=e[t]),t++;return t=e.indexOf("=>",t),t===-1?null:(s=t+2,{name:n,bodyStart:s})}function Os(e,t){let n=1,s="",o=t;for(;o<e.length&&n>0;){const c=e[o];c==="{"&&n++,c==="}"&&n--,s+=c,o++}return{body:s,end:o}}function _s(e){return e.replace(/^const\s*/,"")}const Ns=(e,t)=>{if(!e)return;const n=e.content,s=n.length;let o=0;for(;o<s;){let c="",l="",f=!1;if(n.slice(o,o+8)==="function")o+=8,f=!0,c=xs(n,o),o=Ss(n,o);else if(n.slice(o,o+5)==="const"){const $=Cs(n,o);$&&(f=!0,c=$.name,o=$.bodyStart)}if(f){const{body:$,end:A}=Os(n,o);l=$,o=A,As(c,l,t)}else o++}},Rs=()=>{const e=[];return Xe.length>0&&Xe.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ function size${p}`,description:`ðŸ‘‰ ${w}Functions must be shorter than ${Tt} lines.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/function-size.html`,message:`${t.message} ðŸš¨`})}),e},Ye=[],Wt=3,It=(e,t,n)=>{const s=t.split(",").map(o=>o.trim()).filter(o=>o.length>0);s.length>Wt&&Ye.push({filePath:n,message:`function ${x}${e}${y} has ${x}${s.length}${y} parameters`})},js=(e,t)=>{if(!e)return;const n=/function\s+([\w$]+)\s*\(([^)]*)\)\s*\{|const\s+([\w$]+)\s*=\s*\(([^)]*)\)\s*=>\s*\{/g;let s;for(;(s=n.exec(e.content))!==null;)s[1]?It(s[1],s[2],t):s[3]&&It(s[3],s[4],t)},Fs=()=>{const e=[];return Ye.length>0&&Ye.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ parameter count${p}`,description:`ðŸ‘‰ ${w}Max number of function parameters should be ${Wt}.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/parameter-count.html`,message:`${t.message} ðŸš¨`})}),e},Je=[],Ls=(e,t)=>{if(!e)return;const n=_("defineProps(",R.times.any(),"[",R.times.any(),C(he(`'"`),C(V),he(`'"`),R.times.any(),X(",",R.times.any())),"]",R.times.any(),")",[j]),s=_("<",C(V).grouped(),R,k(">").times.any(),":",C(V).grouped(),R.times.any(),"=",R.times.any(),'"props.',C(V).grouped(),'"',[j]);let o;const c=new Set;for(;(o=n.exec(e.content))!==null;)o[0].replace(/defineProps\(|[)[\]'"\s]/g,"").split(",").forEach($=>c.add($));let l;for(;(l=s.exec(e.content))!==null;){const f=l[1],$=l[2],A=l[3];c.has(A)&&$===A&&Je.push({filePath:t,message:`Prop ${x}(${A})${y} is being drilled through ${x}${f}${y} component unmodified.`})}},Ps=()=>{const e=[];return Je.length>0&&Je.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ props drilling${p}`,description:`ðŸ‘‰ ${w}Props should not be forwarded unmodified. Consider refactoring.${p}`,message:`${t.message} ðŸš¨`})}),e},et=[],Mt=4,Ts=(e,t)=>{if(!e)return;const n=/\b(?:const|var|let)\s+([a-zA-Z_$][\w$]*)/g;let s;for(;(s=n.exec(e.content))!==null;){const o=s[1];o.length<Mt&&et.push({filePath:t,message:`${D}(${o})${y}`})}},Ws=()=>{const e=[];return et.length>0&&et.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ short variable names${p}`,description:`ðŸ‘‰ ${w}Variable names must have a minimum length of ${Mt}.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/short-variable-name.html`,message:`${t.message} ðŸš¨`})}),e},Bt=[],be=[],Is=5,Ms=(e,t)=>{if(!e)return;const n=/const\s+([a-zA-Z0-9_$]+)\s*=\s*computed\(\s*\(\)\s*=>\s*{([^{}]*(?:{[^{}]*}[^{}]*)*)}\s*\)/gs,s=e.content.match(n);s?.length&&s.forEach(o=>{if(o.split(`
`).length>Is){const c=o.split(`
`)[0],l=U(e.content,c);Bt.push({filePath:t,message:`line #${l} ${x}computed${y}`}),be.push({filePath:t}),be.some(f=>f.filePath===t)||be.push({filePath:t})}})},Bs=()=>{const e=[];return be.length>0&&Bt.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ complicated computed property${p}`,description:`ðŸ‘‰ ${w}Refactor the computed properties to smaller ones.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/simple-computed.html`,message:`${t.message} ðŸš¨`})}),e},tt=[],ks=(e,t)=>{if(!e)return;const n=/app\.component\('([^']+)',\s*\{[^}]*\}\)/g;[...e.content.matchAll(n)].map(o=>o[1].trim()).forEach(o=>{const c=U(e.content.trim(),o),l=o.split(`
`).at(0)?.trim()||"";tt.push({filePath:t,message:`line #${c} ${x}(${l})${y}`})})},zs=()=>{const e=[];return tt.length>0&&tt.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ component files${p}`,description:`ðŸ‘‰ ${w}Whenever a build system is available to concatenate files, each component should be in its own file.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-strong/component-files.html`,message:`${t.message} ðŸš¨`})}),e},ye=[],Us=(e,t)=>{if(!e)return;const n=/defineProps\(([^)]+)\)/,s=/v-model\s*=\s*"([^"]+)"/,o=_(q("$parent").or("getCurrentInstance"),[j]),c=e.content.match(n),l=e.content.match(s);if(l){const $=l[1].split(".")[0],A=c?c[1]:"";if(A.includes($)){const O=U(e.content.trim(),A);ye.push({filePath:t,message:`line #${O} ${x}(${$})${y}`})}}const f=e.content.match(o);if(f){const $=U(e.content.trim(),f[0]);ye.push({filePath:t,message:`line #${$} ${x}(${f[0]})${y}`})}},Ds=()=>{const e=[];return ye.length>0&&ye.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-caution ~ implicit parent-child communication${p}`,description:`ðŸ‘‰ ${w}Avoid implicit parent-child communication to maintain clear and predictable component behavior.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-caution/implicit-parent-child-communication.html`,message:`${t.message} ðŸš¨`})}),e},nt=[],kt=5,Vs=3,qs=(e,t)=>{if(!e)return;const n=_(jt.times.atLeast(kt).or(R.times.atLeast(Vs*kt)),[j,G]);e.content.match(n)?.forEach(o=>{const c=U(e.content,o);nt.push({filePath:t,message:`line #${c} ${x}indentation: ${o.length}${y}`})})},Gs=()=>{const e=[];return nt.length>0&&nt.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ deep indentation${p}`,description:`ðŸ‘‰ ${w}Try to refactor your component to child components, to avoid deep indentations.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/deep-indentation.html`,message:`${t.message} ðŸš¨`})}),e},st=[],Ks=(e,t)=>{if(!e)return;const n=_("<a",z,[j,G]),s=e.content.match(n);s?.length&&st.push({filePath:t,message:`${s?.length} ${x}html link found${y}`})},Hs=()=>{const e=[];return st.length>0&&st.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ html link${p}`,description:`ðŸ‘‰ ${w}Use router-link or NuxtLink.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/html-link.html`,message:`${t.message} ðŸš¨`})}),e},ot=[],Qs=(e,t)=>{if(!e)return;const s=e.content.split(`
`);s.forEach((o,c)=>{const l=o.trim();if(l.startsWith("if (")&&!l.includes("{")){const f=s[c+1]?.trim();(!f||!f.startsWith("{")&&!l.endsWith("{"))&&ot.push({filePath:t,message:`line #${c} if statement without curly braces: ${D}${l}${y}`})}})},Zs=()=>{const e=[];return ot.length>0&&ot.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ if without curly braces${p}`,description:`ðŸ‘‰ ${w}All if statements must be enclosed in curly braces for better readability and maintainability.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/if-without-curly-braces.html`,message:`${t.message} ðŸš¨`})}),e},rt=[],Xs=(e,t)=>{if(!e)return;const n=_(Tn,Pn(")",Ft),[j]);e.content.match(n)?.forEach(o=>{const c=U(e.content,o);rt.push({filePath:t,message:`line #${c} ${x}magic number: ${o.length}${y}`})})},Ys=()=>{const e=[];return rt.length>0&&rt.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ magic numbers${p}`,description:`ðŸ‘‰ ${w}Extract magic numbers to a constant.${p} See: https://vue-mess-detector.webmania.cc/rules/rrd/magic-numbers.html`,message:`magic numbers found (${t.message}) ðŸš¨`})}),e},it=[],Js=(e,t)=>{if(!e)return;const n=/<(\w+)([^>]*)>/g;let s;for(;(s=n.exec(e.content))!==null;){const o=s[1],c=s[2];c.split(/\s+/).filter(f=>f.trim()!=="").length>1&&c.split(`
`).length===1&&it.push({filePath:t,message:`Element ${x}<${o}>${y} should have its attributes on separate lines`})}},eo=()=>{const e=[];return it.length>0&&it.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-strong ~ multi-attribute elements${p}`,description:`ðŸ‘‰ ${w}Elements with multiple attributes should span multiple lines, with one attribute per line.${p}`,message:`${t.message} ðŸš¨`})}),e},to=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","search","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],ct=[],no=(e,t)=>{if(!e)return;const n=/([a-z]+)\s*\{[^}]*\}/gi;e.forEach(s=>{let o;for(;(o=n.exec(s.content))!==null;){const c=o[1];to.includes(c)&&ct.push({filePath:t,message:`${x}(${c})${y}`})}})},so=()=>{const e=[];return ct.length>0&&ct.forEach(t=>{e.push({file:t.filePath,rule:`${S}vue-caution ~ element selectors with scoped${p}`,description:`ðŸ‘‰ ${w}Prefer class selectors over element selectors in scoped styles, because large numbers of element selectors are slow.${p} See: https://vue-mess-detector.webmania.cc/rules/vue-caution/element-selectors-with-scoped.html`,message:`${t.message} ðŸš¨`})}),e},at=[],oo=(e,t)=>{if(!e)return;const n=_(C($e),R,"?",R,C($e),R,":",R,C($e));e.content.match(n)?.forEach(o=>{if(o.split("?").length-1>1){const c=U(e.content,o);at.push({filePath:t,message:`line #${c} has ${x}nested ternary${y}`})}})},ro=()=>{const e=[];return at.length>0&&at.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ nested Ternary${p}`,description:`ðŸ‘‰ ${w}/* TODO tip to fix this issue */.${p} See: https:///* TODO doc link */`,message:`${t.message} ðŸš¨`})}),e},lt=[],io=(e,t)=>{if(!e)return;const n=_('v-for="(',R.times.any(),C(V).grouped(),R.times.any(),",",R.times.any(),C(V).grouped(),R.times.any(),")",C(R),"in",C(R),C(V).grouped(),[j]),s=_(':key="',R.times.any(),C(V).grouped(),R.times.any(),'"',[j]),o=[...e.content.matchAll(n)],c=[...e.content.matchAll(s)];o.forEach(l=>{const[f,$,A,O]=l;c.forEach(P=>{const T=P[1];if(T===A){const ie=U(e.content.trim(),T);lt.push({filePath:t,message:`line #${ie} ${x}index is being used as :key in v-for${y}`})}})})},co=()=>{const e=[];return lt.length>0&&lt.forEach(t=>{e.push({file:t.filePath,rule:`${S}rrd ~ VFor With Index Key${p}`,description:`ðŸ‘‰ ${w}Avoid using index as key in v-for loops.${p} See: https://`,message:`${t.message} ðŸš¨`})}),e},ao=e=>{const t={},n=({file:c,rule:l,title:f,description:$,message:A})=>{const O=e==="rule"?l:c;t[O]||(t[O]=[]),t[O].push({file:c,rule:l,title:f,description:$,message:A})},s=c=>{c().forEach(f=>{n(f)})};s(Dn),s(Kn),s(Xn),s(Qn),s(qn),s(Jn),s(zs),s(hs),s(ds),s(eo),s(ns),s(cs),s(ls),s(Bs),s(rs),s($s),s(ys),s(Ds),s(so),s(zn),s(Gs),s(In),s(Rs),s(Hs),s(Zs),s(Ys),s(ro),s(Fs),s(Nn),s(Ps),s(On),s(Ws),s(ws),s(co);const o=[];return Object.keys(t).forEach(c=>{console.log(`
 - ${c}`),t[c].forEach(l=>{const f=l.message.includes(D);if(o.some($=>$.file===l.file)){const $=o.find(A=>A.file===l.file);$&&(f?$.errors++:$.warnings++)}else o.push({file:l.file,errors:f?1:0,warnings:f?0:1});console.log(e==="file"?`   Rule: ${l.rule}`:`   File: ${l.file}`),console.log(`   Description: ${l.description}`),console.log(`   Message: ${l.message||"ðŸš¨"}
`)})}),o},lo=(e,t,n)=>{const s=e.scriptSetup||e.script;console.log(`Analyzing ${t}...`);const o=t.endsWith(".vue");n.includes("vue-essential")&&(Gn(s,t),o&&(Un(t),Vn(e.styles,t),Zn(e.template,t),Hn(e.template,t))),n.includes("vue-strong")&&(Ms(s,t),o&&(ks(s,t),ts(s,t),Yn(t),as(e,t),os(e.template,t),is(e,t),fs(e,t),ps(t),Js(e.template,t))),n.includes("vue-recommended")&&o&&(gs(e.source,t),bs(e.template,t)),n.includes("vue-caution")&&o&&(Us(s,t),no(e.styles,t)),n.includes("rrd")&&(kn(s,t),qs(s,t),Wn(s,t),Ns(s,t),Qs(s,t),Xs(s,t),oo(s,t),js(s,t),Ls(s,t),Cn(s,t),Ts(s,t),vs(s,t),o&&(Ks(e.template,t),_n(e.script,t),io(e.template,t)))};let ut=0,ft=0,zt=[];const uo=["node_modules",".git",".nuxt","dist","coverage"],Ut=async e=>{const t=await Se.readdir(e);for(const n of t){const s=Ce.join(e,n);if((await Se.stat(s)).isDirectory())uo.some(c=>s.includes(c))||await Ut(s);else if(n.endsWith(".vue")||n.endsWith(".ts")||n.endsWith(".js")){ut++;const c=await Se.readFile(s,"utf-8");ft+=c.split(/\r\n|\r|\n/).length;const{descriptor:l}=Xt.parse(c);(n.endsWith(".ts")||n.endsWith(".js"))&&(l.script={content:c}),lo(l,s,zt)}}},fo=async(e,t=[],n)=>{console.log(`

${Z}Analyzing Vue files in ${e}${y}`);const s=oe.filter($=>!t.includes($));console.log(`Applying ${Z}${t.length}${y} rulesets ${Z}${t}${y} and ignoring ${Z}${s.length}${y} rulesets ${Z}${s}${y} grouping by ${Z}${n}${y}`),zt=t,await Ut(e),console.log(`Found ${Z}${ut}${y} Vue files`);const o=ao(n),{errors:c,warnings:l}=o.reduce(($,{errors:A,warnings:O})=>({errors:$.errors+A,warnings:$.warnings+O}),{errors:0,warnings:0});console.log(`Found ${D}${Intl.NumberFormat("en-US").format(c)} errors${y}, and ${x}${Intl.NumberFormat("en-US").format(l)} warnings${y}, ${Z}${Intl.NumberFormat("en-US").format(ft)} lines${y} of code in ${Z}${Intl.NumberFormat("en-US").format(ut)} files${y}`);const f=Math.ceil((1-(c*1.5+l)/ft)*100);f<75&&console.log(`${D}Code health is LOW: ${f}%${y}`),f>=75&&f<85&&console.log(`${x}Code health is MEDIUM ${f}%${y}`),f>=85&&f<95&&console.log(`${Z}Code health is OK: ${f}%${y}`),f>=95&&console.log(`${Nt}Code health is GOOD: ${f}%${y}`),!c&&!l&&console.log(`${Nt}No code smells detected!${y}`)};I(en(process.argv)).command("analyze [path]","Analyze Vue files for code smells and best practices",e=>e.positional("path",{describe:"path to the Vue files",default:"./"}).option("ignore",{alias:"i",describe:"Comma-separated list of rulesets to ignore.",choices:oe,coerce:Dt("ignore"),group:"Filter Rulesets:"}).option("apply",{alias:"a",describe:"Comma-separated list of rulesets to apply.",choices:oe,coerce:Dt("apply"),group:"Filter Rulesets:"}).option("group",{alias:"g",describe:"Group results at the output",choices:["rule","file"],coerce:t=>ho(t),default:"rule",group:"Group Results:"}).check(t=>(t.ignore&&t.apply&&(console.error(`
${D}Cannot use both --ignore and --apply options together.${y}.

`),process.exit(1)),!0)),e=>{let t=[...oe];e.apply&&(t=e.apply),e.ignore&&(t=oe.filter(n=>!e.ignore.includes(n))),fo(e.path,t,e.group)}).help().argv;function Dt(e){return t=>{const n=t.split(","),s=n.filter(o=>!oe.includes(o));return s.length>0&&(console.error(`
${D}Invalid ${e} values: ${s.join(", ")}${y}. 
${w}Allowed values are: ${[...oe].join(", ")}${p}

`),process.exit(1)),n}}function ho(e){return["rule","file"].includes(e)||process.exit(1),e}});
