(function(S,M){typeof exports=="object"&&typeof module<"u"?M(require("yargs"),require("util"),require("path"),require("fs"),require("assert"),require("url"),require("@vue/compiler-sfc")):typeof define=="function"&&define.amd?define(["yargs","util","path","fs","assert","url","@vue/compiler-sfc"],M):(S=typeof globalThis<"u"?globalThis:S||self,M(S.yargs,S.util,S.path,S.fs,S.assert,S.url,S.compilerSfc))})(this,function(S,M,O,L,je,Ke,Qe){"use strict";var Ce=typeof document<"u"?document.currentScript:null;class V extends Error{constructor(e){super(e||"yargs error"),this.name="YError",Error.captureStackTrace&&Error.captureStackTrace(this,V)}}function xe(){return Ye()?0:1}function Ye(){return He()&&!process.defaultApp}function He(){return!!process.versions.electron}function Ze(n){return n.slice(xe()+1)}function Je(){return process.argv[xe()]}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function D(n){if(n!==n.toLowerCase()&&n!==n.toUpperCase()||(n=n.toLowerCase()),n.indexOf("-")===-1&&n.indexOf("_")===-1)return n;{let i="",c=!1;const a=n.match(/^-+/);for(let u=a?a[0].length:0;u<n.length;u++){let p=n.charAt(u);c&&(c=!1,p=p.toUpperCase()),u!==0&&(p==="-"||p==="_")?c=!0:p!=="-"&&p!=="_"&&(i+=p)}return i}}function Se(n,e){const i=n.toLowerCase();e=e||"-";let c="";for(let a=0;a<n.length;a++){const u=i.charAt(a),p=n.charAt(a);u!==p&&a>0?c+=`${e}${i.charAt(a)}`:c+=p}return c}function Ne(n){return n==null?!1:typeof n=="number"||/^0x[0-9a-f]+$/i.test(n)?!0:/^0[^.]/.test(n)?!1:/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(n)}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function Xe(n){if(Array.isArray(n))return n.map(p=>typeof p!="string"?p+"":p);n=n.trim();let e=0,i=null,c=null,a=null;const u=[];for(let p=0;p<n.length;p++){if(i=c,c=n.charAt(p),c===" "&&!a){i!==" "&&e++;continue}c===a?a=null:(c==="'"||c==='"')&&!a&&(a=c),u[e]||(u[e]=""),u[e]+=c}return u}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var N;(function(n){n.BOOLEAN="boolean",n.STRING="string",n.NUMBER="number",n.ARRAY="array"})(N||(N={}));/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */let P;class ke{constructor(e){P=e}parse(e,i){const c=Object.assign({alias:void 0,array:void 0,boolean:void 0,config:void 0,configObjects:void 0,configuration:void 0,coerce:void 0,count:void 0,default:void 0,envPrefix:void 0,narg:void 0,normalize:void 0,string:void 0,number:void 0,__:void 0,key:void 0},i),a=Xe(e),u=typeof e=="string",p=et(Object.assign(Object.create(null),c.alias)),m=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"parse-positional-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},c.configuration),E=Object.assign(Object.create(null),c.default),x=c.configObjects||[],$=c.envPrefix,I=m["populate--"],q=I?"--":"_",le=Object.create(null),Me=Object.create(null),U=c.__||P.format,l={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},B=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,Ae=new RegExp("^--"+m["negation-prefix"]+"(.+)");[].concat(c.array||[]).filter(Boolean).forEach(function(t){const o=typeof t=="object"?t.key:t,f=Object.keys(t).map(function(r){return{boolean:"bools",string:"strings",number:"numbers"}[r]}).filter(Boolean).pop();f&&(l[f][o]=!0),l.arrays[o]=!0,l.keys.push(o)}),[].concat(c.boolean||[]).filter(Boolean).forEach(function(t){l.bools[t]=!0,l.keys.push(t)}),[].concat(c.string||[]).filter(Boolean).forEach(function(t){l.strings[t]=!0,l.keys.push(t)}),[].concat(c.number||[]).filter(Boolean).forEach(function(t){l.numbers[t]=!0,l.keys.push(t)}),[].concat(c.count||[]).filter(Boolean).forEach(function(t){l.counts[t]=!0,l.keys.push(t)}),[].concat(c.normalize||[]).filter(Boolean).forEach(function(t){l.normalize[t]=!0,l.keys.push(t)}),typeof c.narg=="object"&&Object.entries(c.narg).forEach(([t,o])=>{typeof o=="number"&&(l.nargs[t]=o,l.keys.push(t))}),typeof c.coerce=="object"&&Object.entries(c.coerce).forEach(([t,o])=>{typeof o=="function"&&(l.coercions[t]=o,l.keys.push(t))}),typeof c.config<"u"&&(Array.isArray(c.config)||typeof c.config=="string"?[].concat(c.config).filter(Boolean).forEach(function(t){l.configs[t]=!0}):typeof c.config=="object"&&Object.entries(c.config).forEach(([t,o])=>{(typeof o=="boolean"||typeof o=="function")&&(l.configs[t]=o)})),Ht(c.key,p,c.default,l.arrays),Object.keys(E).forEach(function(t){(l.aliases[t]||[]).forEach(function(o){E[o]=E[t]})});let F=null;tn();let fe=[];const A=Object.assign(Object.create(null),{_:[]}),qe={};for(let t=0;t<a.length;t++){const o=a[t],f=o.replace(/^-{3,}/,"---");let r,s,d,h,g,_;if(o!=="--"&&/^-/.test(o)&&pe(o))_e(o);else if(f.match(/^---+(=|$)/)){_e(o);continue}else if(o.match(/^--.+=/)||!m["short-option-groups"]&&o.match(/^-.+=/))h=o.match(/^--?([^=]+)=([\s\S]*)$/),h!==null&&Array.isArray(h)&&h.length>=3&&(y(h[1],l.arrays)?t=he(t,h[1],a,h[2]):y(h[1],l.nargs)!==!1?t=ue(t,h[1],a,h[2]):b(h[1],h[2],!0));else if(o.match(Ae)&&m["boolean-negation"])h=o.match(Ae),h!==null&&Array.isArray(h)&&h.length>=2&&(s=h[1],b(s,y(s,l.arrays)?[!1]:!1));else if(o.match(/^--.+/)||!m["short-option-groups"]&&o.match(/^-[^-]+/))h=o.match(/^--?(.+)/),h!==null&&Array.isArray(h)&&h.length>=2&&(s=h[1],y(s,l.arrays)?t=he(t,s,a):y(s,l.nargs)!==!1?t=ue(t,s,a):(g=a[t+1],g!==void 0&&(!g.match(/^-/)||g.match(B))&&!y(s,l.bools)&&!y(s,l.counts)||/^(true|false)$/.test(g)?(b(s,g),t++):b(s,G(s))));else if(o.match(/^-.\..+=/))h=o.match(/^-([^=]+)=([\s\S]*)$/),h!==null&&Array.isArray(h)&&h.length>=3&&b(h[1],h[2]);else if(o.match(/^-.\..+/)&&!o.match(B))g=a[t+1],h=o.match(/^-(.\..+)/),h!==null&&Array.isArray(h)&&h.length>=2&&(s=h[1],g!==void 0&&!g.match(/^-/)&&!y(s,l.bools)&&!y(s,l.counts)?(b(s,g),t++):b(s,G(s)));else if(o.match(/^-[^-]+/)&&!o.match(B)){d=o.slice(1,-1).split(""),r=!1;for(let j=0;j<d.length;j++){if(g=o.slice(j+2),d[j+1]&&d[j+1]==="="){_=o.slice(j+3),s=d[j],y(s,l.arrays)?t=he(t,s,a,_):y(s,l.nargs)!==!1?t=ue(t,s,a,_):b(s,_),r=!0;break}if(g==="-"){b(d[j],g);continue}if(/[A-Za-z]/.test(d[j])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(g)&&y(g,l.bools)===!1){b(d[j],g),r=!0;break}if(d[j+1]&&d[j+1].match(/\W/)){b(d[j],g),r=!0;break}else b(d[j],G(d[j]))}s=o.slice(-1)[0],!r&&s!=="-"&&(y(s,l.arrays)?t=he(t,s,a):y(s,l.nargs)!==!1?t=ue(t,s,a):(g=a[t+1],g!==void 0&&(!/^(-|--)[^-]/.test(g)||g.match(B))&&!y(s,l.bools)&&!y(s,l.counts)||/^(true|false)$/.test(g)?(b(s,g),t++):b(s,G(s))))}else if(o.match(/^-[0-9]$/)&&o.match(B)&&y(o.slice(1),l.bools))s=o.slice(1),b(s,G(s));else if(o==="--"){fe=a.slice(t+1);break}else if(m["halt-at-non-option"]){fe=a.slice(t);break}else _e(o)}Ge(A,!0),Ge(A,!1),Dt(A),Kt(),Ve(A,l.aliases,E,!0),Qt(A),m["set-placeholder-key"]&&Yt(A),Object.keys(l.counts).forEach(function(t){oe(A,t.split("."))||b(t,0)}),I&&fe.length&&(A[q]=[]),fe.forEach(function(t){A[q].push(t)}),m["camel-case-expansion"]&&m["strip-dashed"]&&Object.keys(A).filter(t=>t!=="--"&&t.includes("-")).forEach(t=>{delete A[t]}),m["strip-aliased"]&&[].concat(...Object.keys(p).map(t=>p[t])).forEach(t=>{m["camel-case-expansion"]&&t.includes("-")&&delete A[t.split(".").map(o=>D(o)).join(".")],delete A[t]});function _e(t){const o=de("_",t);(typeof o=="string"||typeof o=="number")&&A._.push(o)}function ue(t,o,f,r){let s,d=y(o,l.nargs);if(d=typeof d!="number"||isNaN(d)?1:d,d===0)return z(r)||(F=Error(U("Argument unexpected for: %s",o))),b(o,G(o)),t;let h=z(r)?0:1;if(m["nargs-eats-options"])f.length-(t+1)+h<d&&(F=Error(U("Not enough arguments following: %s",o))),h=d;else{for(s=t+1;s<f.length&&(!f[s].match(/^-[^0-9]/)||f[s].match(B)||pe(f[s]));s++)h++;h<d&&(F=Error(U("Not enough arguments following: %s",o)))}let g=Math.min(h,d);for(!z(r)&&g>0&&(b(o,r),g--),s=t+1;s<g+t+1;s++)b(o,f[s]);return t+g}function he(t,o,f,r){let s=[],d=r||f[t+1];const h=y(o,l.nargs);if(y(o,l.bools)&&!/^(true|false)$/.test(d))s.push(!0);else if(z(d)||z(r)&&/^-/.test(d)&&!B.test(d)&&!pe(d)){if(E[o]!==void 0){const g=E[o];s=Array.isArray(g)?g:[g]}}else{z(r)||s.push(we(o,r,!0));for(let g=t+1;g<f.length&&!(!m["greedy-arrays"]&&s.length>0||h&&typeof h=="number"&&s.length>=h||(d=f[g],/^-/.test(d)&&!B.test(d)&&!pe(d)));g++)t=g,s.push(we(o,d,u))}return typeof h=="number"&&(h&&s.length<h||isNaN(h)&&s.length===0)&&(F=Error(U("Not enough arguments following: %s",o))),b(o,s),t}function b(t,o,f=u){if(/-/.test(t)&&m["camel-case-expansion"]){const d=t.split(".").map(function(h){return D(h)}).join(".");Ue(t,d)}const r=we(t,o,f),s=t.split(".");re(A,s,r),l.aliases[t]&&l.aliases[t].forEach(function(d){const h=d.split(".");re(A,h,r)}),s.length>1&&m["dot-notation"]&&(l.aliases[s[0]]||[]).forEach(function(d){let h=d.split(".");const g=[].concat(s);g.shift(),h=h.concat(g),(l.aliases[t]||[]).includes(h.join("."))||re(A,h,r)}),y(t,l.normalize)&&!y(t,l.arrays)&&[t].concat(l.aliases[t]||[]).forEach(function(h){Object.defineProperty(qe,h,{enumerable:!0,get(){return o},set(g){o=typeof g=="string"?P.normalize(g):g}})})}function Ue(t,o){l.aliases[t]&&l.aliases[t].length||(l.aliases[t]=[o],le[o]=!0),l.aliases[o]&&l.aliases[o].length||Ue(o,t)}function we(t,o,f){f&&(o=tt(o)),(y(t,l.bools)||y(t,l.counts))&&typeof o=="string"&&(o=o==="true");let r=Array.isArray(o)?o.map(function(s){return de(t,s)}):de(t,o);return y(t,l.counts)&&(z(r)||typeof r=="boolean")&&(r=ge()),y(t,l.normalize)&&y(t,l.arrays)&&(Array.isArray(o)?r=o.map(s=>P.normalize(s)):r=P.normalize(o)),r}function de(t,o){return!m["parse-positional-numbers"]&&t==="_"||!y(t,l.strings)&&!y(t,l.bools)&&!Array.isArray(o)&&(Ne(o)&&m["parse-numbers"]&&Number.isSafeInteger(Math.floor(parseFloat(`${o}`)))||!z(o)&&y(t,l.numbers))&&(o=Number(o)),o}function Dt(t){const o=Object.create(null);Ve(o,l.aliases,E),Object.keys(l.configs).forEach(function(f){const r=t[f]||o[f];if(r)try{let s=null;const d=P.resolve(P.cwd(),r),h=l.configs[f];if(typeof h=="function"){try{s=h(d)}catch(g){s=g}if(s instanceof Error){F=s;return}}else s=P.require(d);Oe(s)}catch(s){s.name==="PermissionDenied"?F=s:t[f]&&(F=Error(U("Invalid JSON config file: %s",r)))}})}function Oe(t,o){Object.keys(t).forEach(function(f){const r=t[f],s=o?o+"."+f:f;typeof r=="object"&&r!==null&&!Array.isArray(r)&&m["dot-notation"]?Oe(r,s):(!oe(A,s.split("."))||y(s,l.arrays)&&m["combine-arrays"])&&b(s,r)})}function Kt(){typeof x<"u"&&x.forEach(function(t){Oe(t)})}function Ge(t,o){if(typeof $>"u")return;const f=typeof $=="string"?$:"",r=P.env();Object.keys(r).forEach(function(s){if(f===""||s.lastIndexOf(f,0)===0){const d=s.split("__").map(function(h,g){return g===0&&(h=h.substring(f.length)),D(h)});(o&&l.configs[d.join(".")]||!o)&&!oe(t,d)&&b(d.join("."),r[s])}})}function Qt(t){let o;const f=new Set;Object.keys(t).forEach(function(r){if(!f.has(r)&&(o=y(r,l.coercions),typeof o=="function"))try{const s=de(r,o(t[r]));[].concat(l.aliases[r]||[],r).forEach(d=>{f.add(d),t[d]=s})}catch(s){F=s}})}function Yt(t){return l.keys.forEach(o=>{~o.indexOf(".")||typeof t[o]>"u"&&(t[o]=void 0)}),t}function Ve(t,o,f,r=!1){Object.keys(f).forEach(function(s){oe(t,s.split("."))||(re(t,s.split("."),f[s]),r&&(Me[s]=!0),(o[s]||[]).forEach(function(d){oe(t,d.split("."))||re(t,d.split("."),f[s])}))})}function oe(t,o){let f=t;m["dot-notation"]||(o=[o.join(".")]),o.slice(0,-1).forEach(function(s){f=f[s]||{}});const r=o[o.length-1];return typeof f!="object"?!1:r in f}function re(t,o,f){let r=t;m["dot-notation"]||(o=[o.join(".")]),o.slice(0,-1).forEach(function(_){_=ve(_),typeof r=="object"&&r[_]===void 0&&(r[_]={}),typeof r[_]!="object"||Array.isArray(r[_])?(Array.isArray(r[_])?r[_].push({}):r[_]=[r[_],{}],r=r[_][r[_].length-1]):r=r[_]});const s=ve(o[o.length-1]),d=y(o.join("."),l.arrays),h=Array.isArray(f);let g=m["duplicate-arguments-array"];!g&&y(s,l.nargs)&&(g=!0,(!z(r[s])&&l.nargs[s]===1||Array.isArray(r[s])&&r[s].length===l.nargs[s])&&(r[s]=void 0)),f===ge()?r[s]=ge(r[s]):Array.isArray(r[s])?g&&d&&h?r[s]=m["flatten-duplicate-arrays"]?r[s].concat(f):(Array.isArray(r[s][0])?r[s]:[r[s]]).concat([f]):!g&&!!d==!!h?r[s]=f:r[s]=r[s].concat([f]):r[s]===void 0&&d?r[s]=h?f:[f]:g&&!(r[s]===void 0||y(s,l.counts)||y(s,l.bools))?r[s]=[r[s],f]:r[s]=f}function Ht(...t){t.forEach(function(o){Object.keys(o||{}).forEach(function(f){l.aliases[f]||(l.aliases[f]=[].concat(p[f]||[]),l.aliases[f].concat(f).forEach(function(r){if(/-/.test(r)&&m["camel-case-expansion"]){const s=D(r);s!==f&&l.aliases[f].indexOf(s)===-1&&(l.aliases[f].push(s),le[s]=!0)}}),l.aliases[f].concat(f).forEach(function(r){if(r.length>1&&/[A-Z]/.test(r)&&m["camel-case-expansion"]){const s=Se(r,"-");s!==f&&l.aliases[f].indexOf(s)===-1&&(l.aliases[f].push(s),le[s]=!0)}}),l.aliases[f].forEach(function(r){l.aliases[r]=[f].concat(l.aliases[f].filter(function(s){return r!==s}))}))})})}function y(t,o){const f=[].concat(l.aliases[t]||[],t),r=Object.keys(o),s=f.find(d=>r.includes(d));return s?o[s]:!1}function De(t){const o=Object.keys(l);return[].concat(o.map(r=>l[r])).some(function(r){return Array.isArray(r)?r.includes(t):r[t]})}function Zt(t,...o){return[].concat(...o).some(function(r){const s=t.match(r);return s&&De(s[1])})}function Jt(t){if(t.match(B)||!t.match(/^-[^-]+/))return!1;let o=!0,f;const r=t.slice(1).split("");for(let s=0;s<r.length;s++){if(f=t.slice(s+2),!De(r[s])){o=!1;break}if(r[s+1]&&r[s+1]==="="||f==="-"||/[A-Za-z]/.test(r[s])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(f)||r[s+1]&&r[s+1].match(/\W/))break}return o}function pe(t){return m["unknown-options-as-args"]&&Xt(t)}function Xt(t){return t=t.replace(/^-{3,}/,"--"),t.match(B)||Jt(t)?!1:!Zt(t,/^-+([^=]+?)=[\s\S]*$/,Ae,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}function G(t){return!y(t,l.bools)&&!y(t,l.counts)&&`${t}`in E?E[t]:kt(en(t))}function kt(t){return{[N.BOOLEAN]:!0,[N.STRING]:"",[N.NUMBER]:void 0,[N.ARRAY]:[]}[t]}function en(t){let o=N.BOOLEAN;return y(t,l.strings)?o=N.STRING:y(t,l.numbers)?o=N.NUMBER:y(t,l.bools)?o=N.BOOLEAN:y(t,l.arrays)&&(o=N.ARRAY),o}function z(t){return t===void 0}function tn(){Object.keys(l.counts).find(t=>y(t,l.arrays)?(F=Error(U("Invalid configuration: %s, opts.count excludes opts.array.",t)),!0):y(t,l.nargs)?(F=Error(U("Invalid configuration: %s, opts.count excludes opts.narg.",t)),!0):!1)}return{aliases:Object.assign({},l.aliases),argv:Object.assign(qe,A),configuration:m,defaulted:Object.assign({},Me),error:F,newAliases:Object.assign({},le)}}}function et(n){const e=[],i=Object.create(null);let c=!0;for(Object.keys(n).forEach(function(a){e.push([].concat(n[a],a))});c;){c=!1;for(let a=0;a<e.length;a++)for(let u=a+1;u<e.length;u++)if(e[a].filter(function(m){return e[u].indexOf(m)!==-1}).length){e[a]=e[a].concat(e[u]),e.splice(u,1),c=!0;break}}return e.forEach(function(a){a=a.filter(function(p,m,E){return E.indexOf(p)===m});const u=a.pop();u!==void 0&&typeof u=="string"&&(i[u]=a)}),i}function ge(n){return n!==void 0?n+1:1}function ve(n){return n==="__proto__"?"___proto___":n}function tt(n){return typeof n=="string"&&(n[0]==="'"||n[0]==='"')&&n[n.length-1]===n[0]?n.substring(1,n.length-1):n}/**
 * @fileoverview Main entrypoint for libraries using yargs-parser in Node.js
 * CJS and ESM environments.
 *
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var me,ye,be;const Fe=process&&process.env&&process.env.YARGS_MIN_NODE_VERSION?Number(process.env.YARGS_MIN_NODE_VERSION):12,Le=(ye=(me=process==null?void 0:process.versions)===null||me===void 0?void 0:me.node)!==null&&ye!==void 0?ye:(be=process==null?void 0:process.version)===null||be===void 0?void 0:be.slice(1);if(Le&&Number(Le.match(/^([^.]+)/)[1])<Fe)throw Error(`yargs parser supports a minimum Node.js version of ${Fe}. Read our version support policy: https://github.com/yargs/yargs-parser#supported-nodejs-versions`);const nt=process?process.env:{},Re=new ke({cwd:process.cwd,env:()=>nt,format:M.format,normalize:O.normalize,resolve:O.resolve,require:n=>{if(typeof require<"u")return require(n);if(n.match(/\.json$/))return JSON.parse(L.readFileSync(n,"utf8"));throw Error("only .json config files are supported in ESM")}}),K=function(e,i){return Re.parse(e.slice(),i).argv};K.detailed=function(n,e){return Re.parse(n.slice(),e)},K.camelCase=D,K.decamelize=Se,K.looksLikeNumber=Ne;const st={right:lt,center:ft},it=0,ce=1,ot=2,ae=3;class rt{constructor(e){var i;this.width=e.width,this.wrap=(i=e.wrap)!==null&&i!==void 0?i:!0,this.rows=[]}span(...e){const i=this.div(...e);i.span=!0}resetOutput(){this.rows=[]}div(...e){if(e.length===0&&this.div(""),this.wrap&&this.shouldApplyLayoutDSL(...e)&&typeof e[0]=="string")return this.applyLayoutDSL(e[0]);const i=e.map(c=>typeof c=="string"?this.colFromString(c):c);return this.rows.push(i),i}shouldApplyLayoutDSL(...e){return e.length===1&&typeof e[0]=="string"&&/[\t\n]/.test(e[0])}applyLayoutDSL(e){const i=e.split(`
`).map(a=>a.split("	"));let c=0;return i.forEach(a=>{a.length>1&&C.stringWidth(a[0])>c&&(c=Math.min(Math.floor(this.width*.5),C.stringWidth(a[0])))}),i.forEach(a=>{this.div(...a.map((u,p)=>({text:u.trim(),padding:this.measurePadding(u),width:p===0&&a.length>1?c:void 0})))}),this.rows[this.rows.length-1]}colFromString(e){return{text:e,padding:this.measurePadding(e)}}measurePadding(e){const i=C.stripAnsi(e);return[0,i.match(/\s*$/)[0].length,0,i.match(/^\s*/)[0].length]}toString(){const e=[];return this.rows.forEach(i=>{this.rowToString(i,e)}),e.filter(i=>!i.hidden).map(i=>i.text).join(`
`)}rowToString(e,i){return this.rasterize(e).forEach((c,a)=>{let u="";c.forEach((p,m)=>{const{width:E}=e[m],x=this.negatePadding(e[m]);let $=p;if(x>C.stringWidth(p)&&($+=" ".repeat(x-C.stringWidth(p))),e[m].align&&e[m].align!=="left"&&this.wrap){const q=st[e[m].align];$=q($,x),C.stringWidth($)<x&&($+=" ".repeat((E||0)-C.stringWidth($)-1))}const I=e[m].padding||[0,0,0,0];I[ae]&&(u+=" ".repeat(I[ae])),u+=We(e[m],$,"| "),u+=$,u+=We(e[m],$," |"),I[ce]&&(u+=" ".repeat(I[ce])),a===0&&i.length>0&&(u=this.renderInline(u,i[i.length-1]))}),i.push({text:u.replace(/ +$/,""),span:e.span})}),i}renderInline(e,i){const c=e.match(/^ */),a=c?c[0].length:0,u=i.text,p=C.stringWidth(u.trimRight());return i.span?this.wrap?a<p?e:(i.hidden=!0,u.trimRight()+" ".repeat(a-p)+e.trimLeft()):(i.hidden=!0,u+e):e}rasterize(e){const i=[],c=this.columnWidths(e);let a;return e.forEach((u,p)=>{u.width=c[p],this.wrap?a=C.wrap(u.text,this.negatePadding(u),{hard:!0}).split(`
`):a=u.text.split(`
`),u.border&&(a.unshift("."+"-".repeat(this.negatePadding(u)+2)+"."),a.push("'"+"-".repeat(this.negatePadding(u)+2)+"'")),u.padding&&(a.unshift(...new Array(u.padding[it]||0).fill("")),a.push(...new Array(u.padding[ot]||0).fill(""))),a.forEach((m,E)=>{i[E]||i.push([]);const x=i[E];for(let $=0;$<p;$++)x[$]===void 0&&x.push("");x.push(m)})}),i}negatePadding(e){let i=e.width||0;return e.padding&&(i-=(e.padding[ae]||0)+(e.padding[ce]||0)),e.border&&(i-=4),i}columnWidths(e){if(!this.wrap)return e.map(p=>p.width||C.stringWidth(p.text));let i=e.length,c=this.width;const a=e.map(p=>{if(p.width)return i--,c-=p.width,p.width}),u=i?Math.floor(c/i):0;return a.map((p,m)=>p===void 0?Math.max(u,ct(e[m])):p)}}function We(n,e,i){return n.border?/[.']-+[.']/.test(e)?"":e.trim().length!==0?i:"  ":""}function ct(n){const e=n.padding||[],i=1+(e[ae]||0)+(e[ce]||0);return n.border?i+4:i}function at(){return typeof process=="object"&&process.stdout&&process.stdout.columns?process.stdout.columns:80}function lt(n,e){n=n.trim();const i=C.stringWidth(n);return i<e?" ".repeat(e-i)+n:n}function ft(n,e){n=n.trim();const i=C.stringWidth(n);return i>=e?n:" ".repeat(e-i>>1)+n}let C;function ut(n,e){return C=e,new rt({width:n?.width||at(),wrap:n?.wrap})}const Te=new RegExp("\x1B(?:\\[(?:\\d+[ABCDEFGJKSTm]|\\d+;\\d+[Hfm]|\\d+;\\d+;\\d+m|6n|s|u|\\?25[lh])|\\w)","g");function Be(n){return n.replace(Te,"")}function ht(n,e){const[i,c]=n.match(Te)||["",""];n=Be(n);let a="";for(let u=0;u<n.length;u++)u!==0&&u%e===0&&(a+=`
`),a+=n.charAt(u);return i&&c&&(a=`${i}${a}${c}`),a}function dt(n){return ut(n,{stringWidth:e=>[...e].length,stripAnsi:Be,wrap:ht})}function pt(n,e){let i=O.resolve(".",n),c;for(L.statSync(i).isDirectory()||(i=O.dirname(i));;){if(c=e(i,L.readdirSync(i)),c)return O.resolve(i,c);if(i=O.dirname(c=i),c===i)break}}const gt={fs:{readFileSync:L.readFileSync,writeFile:L.writeFile},format:M.format,resolve:O.resolve,exists:n=>{try{return L.statSync(n).isFile()}catch{return!1}}};let v;class mt{constructor(e){e=e||{},this.directory=e.directory||"./locales",this.updateFiles=typeof e.updateFiles=="boolean"?e.updateFiles:!0,this.locale=e.locale||"en",this.fallbackToLanguage=typeof e.fallbackToLanguage=="boolean"?e.fallbackToLanguage:!0,this.cache=Object.create(null),this.writeQueue=[]}__(...e){if(typeof arguments[0]!="string")return this._taggedLiteral(arguments[0],...arguments);const i=e.shift();let c=function(){};return typeof e[e.length-1]=="function"&&(c=e.pop()),c=c||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][i]&&this.updateFiles?(this.cache[this.locale][i]=i,this._enqueueWrite({directory:this.directory,locale:this.locale,cb:c})):c(),v.format.apply(v.format,[this.cache[this.locale][i]||i].concat(e))}__n(){const e=Array.prototype.slice.call(arguments),i=e.shift(),c=e.shift(),a=e.shift();let u=function(){};typeof e[e.length-1]=="function"&&(u=e.pop()),this.cache[this.locale]||this._readLocaleFile();let p=a===1?i:c;this.cache[this.locale][i]&&(p=this.cache[this.locale][i][a===1?"one":"other"]),!this.cache[this.locale][i]&&this.updateFiles?(this.cache[this.locale][i]={one:i,other:c},this._enqueueWrite({directory:this.directory,locale:this.locale,cb:u})):u();const m=[p];return~p.indexOf("%d")&&m.push(a),v.format.apply(v.format,m.concat(e))}setLocale(e){this.locale=e}getLocale(){return this.locale}updateLocale(e){this.cache[this.locale]||this._readLocaleFile();for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(this.cache[this.locale][i]=e[i])}_taggedLiteral(e,...i){let c="";return e.forEach(function(a,u){const p=i[u+1];c+=a,typeof p<"u"&&(c+="%s")}),this.__.apply(this,[c].concat([].slice.call(i,1)))}_enqueueWrite(e){this.writeQueue.push(e),this.writeQueue.length===1&&this._processWriteQueue()}_processWriteQueue(){const e=this,i=this.writeQueue[0],c=i.directory,a=i.locale,u=i.cb,p=this._resolveLocaleFile(c,a),m=JSON.stringify(this.cache[a],null,2);v.fs.writeFile(p,m,"utf-8",function(E){e.writeQueue.shift(),e.writeQueue.length>0&&e._processWriteQueue(),u(E)})}_readLocaleFile(){let e={};const i=this._resolveLocaleFile(this.directory,this.locale);try{v.fs.readFileSync&&(e=JSON.parse(v.fs.readFileSync(i,"utf-8")))}catch(c){if(c instanceof SyntaxError&&(c.message="syntax error in "+i),c.code==="ENOENT")e={};else throw c}this.cache[this.locale]=e}_resolveLocaleFile(e,i){let c=v.resolve(e,"./",i+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(c)&&~i.lastIndexOf("_")){const a=v.resolve(e,"./",i.split("_")[0]+".json");this._fileExistsSync(a)&&(c=a)}return c}_fileExistsSync(e){return v.exists(e)}}function yt(n,e){v=e;const i=new mt(n);return{__:i.__.bind(i),__n:i.__n.bind(i),setLocale:i.setLocale.bind(i),getLocale:i.getLocale.bind(i),updateLocale:i.updateLocale.bind(i),locale:i.locale}}const bt=n=>yt(n,gt),Et="require is not supported by ESM",Pe="loading a directory of commands is not supported yet for ESM";let Q;try{Q=Ke.fileURLToPath(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:Ce&&Ce.src||new URL("vue-mess-detector.umd.js",document.baseURI).href)}catch{Q=process.cwd()}const $t=Q.substring(0,Q.lastIndexOf("node_modules"));je.notStrictEqual,je.strictEqual,M.inspect,$t||process.cwd(),O.basename,O.dirname,O.extname,O.relative,O.resolve,process.cwd,process.exit,process.nextTick,typeof process.stdout.columns<"u"&&process.stdout.columns,L.readFileSync,bt({directory:O.resolve(Q,"../../../locales"),updateFiles:!1});const Ee="\x1B[44m",Y="\x1B[43m",R="\x1B[41m",At="\x1B[42m",w="\x1B[0m",W="\x1B[33m",T="\x1B[0m",$e=50,H=[],_t=(n,e)=>{const i=n.content.split(`
`);i.length>$e&&H.push({fileName:e,scriptLength:i.length})},wt=()=>(H.length>0&&(console.log(`
${R}Long <script> blocks${w} in ${H.length} files.`),console.log(`ðŸ‘‰ ${W}Try to refactor out the logic into composable functions or other files and keep the script block's length under ${$e} lines.${T}`),H.forEach(n=>{console.log(`- ${n.fileName} ${n.scriptLength>$e*2?R:Y}(${n.scriptLength} lines)${w}`)})),H.length),Z=[],Ot=n=>{Z.push(n)},jt=()=>(Z.length>0&&(console.log(`
${Y}Plain <script> blocks${w} in ${Z.length} files.`),console.log(`ðŸ‘‰ ${W} Consider using <script setup> to leverage the new SFC <script> syntax.${T}`),Z.forEach(n=>{console.log(`- ${n}`)})),Z.length),J=[],Ct=(n,e)=>{const i=/\belse\b/gi,c=n.content.match(i);c?.length&&J.push({fileName:e,elseCount:c.length})},xt=()=>(J.length>0&&(console.log(`
${Y}else conditions${w} are used in ${J.length} files.`),console.log(`ðŸ‘‰ ${W}Try to rewrite the conditions in a way that the else clause is not necessary.${T}`),J.forEach(n=>{console.log(`- ${n.fileName} ${Y}(${n.elseCount})${w}`)})),J.length),St=5,Nt=10,X=[],vt=(n,e)=>{const i=/\bif\b/gi,c=/\belse\b/gi,a=/\bfor\b/gi,u=/\bwhile\b/gi,p=/\bcase\b/gi,m=n.content.match(i),E=n.content.match(c),x=n.content.match(a),$=n.content.match(u),I=n.content.match(p),q=(m?.length||0)+(E?.length||0)+(x?.length||0)+($?.length||0)+(I?.length||0);q>St&&X.push({fileName:e,cyclomaticComplexity:q})},Ft=()=>(X.length>0&&(console.log(`
${Ee}cyclomaticComplexity${w} is above moderate in ${X.length} files.`),console.log(`ðŸ‘‰ ${W}Try to reduce complexity.${T}`),X.forEach(n=>{console.log(`- ${n.fileName} ${n.cyclomaticComplexity>Nt?R:Y}(${n.cyclomaticComplexity})${w}`)})),X.length),k=[],Lt=n=>{if(n.includes("pages"))return;const e=O.basename(n);if(e==="App.vue")return;const i=/[A-Z]/;e.slice(1).match(i)?.length||k.push({filePath:n})},Rt=()=>(k.length>0&&(console.log(`
${R}single name component${w} is used in ${k.length} files.`),console.log(`ðŸ‘‰ ${W}Rename the component to use multi-word name.${T} See: https://vuejs.org/style-guide/rules-essential.html#use-multi-word-component-names`),k.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),k.length),ee=[],Wt=(n,e)=>{n.scoped||ee.push({filePath:e})},Tt=()=>(ee.length>0&&(console.log(`
${R}Global style ${w} is used in ${ee.length} files.`),console.log(`ðŸ‘‰ ${W}Use <style scoped>.${T} See: https://vuejs.org/style-guide/rules-essential.html#use-component-scoped-styling`),ee.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),ee.length),te=[],Bt=(n,e)=>{const i=/defineProps\(\[/gi;n.content.match(i)?.length&&te.push({filePath:e})},Pt=()=>(te.length>0&&(console.log(`
${R}simple prop${w} is used in ${te.length} files.`),console.log(`ðŸ‘‰ ${W}Add at least type definition.${T} See: https://vuejs.org/style-guide/rules-essential.html#use-detailed-prop-definitions`),te.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),te.length),ne=[],It=(n,e)=>{const i=/<[^>]+ v-if[^>]+ v-for[^>]+>/gi,c=/<[^>]+ v-for[^>]+ v-if[^>]+>/gi,a=n.content.match(i),u=n.content.match(c);(a?.length||u?.length)&&ne.push({filePath:e})},zt=()=>(ne.length>0&&(console.log(`
${R}v-if used with v-for${w} in ${ne.length} files.`),console.log(`ðŸ‘‰ ${W}Move out the v-if to a computed property.${T} See: https://vuejs.org/style-guide/rules-essential.html#avoid-v-if-with-v-for`),ne.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),ne.length),se=[],Mt=(n,e)=>{const i=/<[^>]+ v-for[^>]+>/gi,c=n.content.match(i);c?.length&&(c.some(u=>u.includes(":key"))||se.push({filePath:e}))},qt=()=>(se.length>0&&(console.log(`
${R}v-for has no key${w} in ${se.length} files.`),console.log(`ðŸ‘‰ ${W}Add a \`:key\` property to all v-for.${T} See: https://vuejs.org/style-guide/rules-essential.html#use-keyed-v-for`),se.forEach(n=>{console.log(`- ${n.filePath} ðŸš¨`)})),se.length),ie=[],Ut=n=>{const e=O.basename(n),i=/^[A-Z][a-zA-Z0-9]+(?:(?<!^)(?=[A-Z]))*.vue$/,c=e.match(i),a=/^([a-z0-9]+-)+[a-z0-9]+\.vue$/,u=e.match(a);!c?.length&&!u?.length&&ie.push({fileName:n})},Gt=()=>(ie.length>0&&(console.log(`
${R}component name is not PascalCase and not kebab-abse${w} in ${ie.length} files.`),console.log(`ðŸ‘‰ ${W}Rename the component to use PascalCase or kebab-case file name.${T} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#single-file-component-filename-casing`),ie.forEach(n=>{console.log(`- ${R}${n.fileName}${w}`)})),ie.length);let Ie=0;const ze=(n,e)=>{const i=L.readdirSync(n);Ie+=i.length;for(const c of i){const a=O.join(n,c);L.statSync(a).isDirectory()?ze(a,e):c.endsWith(".vue")&&e(a)}},Vt=n=>{console.log(`

${Ee}Analyzing Vue files in ${n}${w}`);let e=0;ze(n,i=>{const c=L.readFileSync(i,"utf-8"),{descriptor:a}=Qe.parse(c);Lt(i),Ut(i),a.script&&Ot(i);const u=a.scriptSetup||a.script;u&&(Bt(u,i),_t(u,i),vt(u,i),Ct(u,i)),a.styles.forEach(p=>{Wt(p,i)}),a.template&&(Mt(a.template,i),It(a.template,i))}),console.log(`Found ${Ee}${Ie}${w} Vue files`),e+=Rt(),e+=Pt(),e+=qt(),e+=zt(),e+=Tt(),e+=Gt(),e+=wt(),e+=jt(),e+=Ft(),e+=xt(),e||console.log(`${At}No code smells detected!${w}`)};S(Ze(process.argv)).command("analyze [path]","Analyze Vue files for code smells",n=>n.positional("path",{describe:"path to the Vue files",type:"string",default:"./src"}),n=>{Vt(n.path)}).help().argv});
