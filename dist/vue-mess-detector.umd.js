(function(R,V){typeof exports=="object"&&typeof module<"u"?V(require("yargs"),require("util"),require("path"),require("fs"),require("assert"),require("url"),require("@vue/compiler-sfc")):typeof define=="function"&&define.amd?define(["yargs","util","path","fs","assert","url","@vue/compiler-sfc"],V):(R=typeof globalThis<"u"?globalThis:R||self,V(R.yargs,R.util,R.path,R.fs,R.assert,R.url,R.compilerSfc))})(this,function(R,V,x,T,Le,ot,rt){"use strict";var We=typeof document<"u"?document.currentScript:null;class Y extends Error{constructor(t){super(t||"yargs error"),this.name="YError",Error.captureStackTrace&&Error.captureStackTrace(this,Y)}}function Pe(){return it()?0:1}function it(){return ct()&&!process.defaultApp}function ct(){return!!process.versions.electron}function at(e){return e.slice(Pe()+1)}function lt(){return process.argv[Pe()]}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function H(e){if(e!==e.toLowerCase()&&e!==e.toUpperCase()||(e=e.toLowerCase()),e.indexOf("-")===-1&&e.indexOf("_")===-1)return e;{let s="",i=!1;const c=e.match(/^-+/);for(let f=c?c[0].length:0;f<e.length;f++){let d=e.charAt(f);i&&(i=!1,d=d.toUpperCase()),f!==0&&(d==="-"||d==="_")?i=!0:d!=="-"&&d!=="_"&&(s+=d)}return s}}function Te(e,t){const s=e.toLowerCase();t=t||"-";let i="";for(let c=0;c<e.length;c++){const f=s.charAt(c),d=e.charAt(c);f!==d&&c>0?i+=`${t}${s.charAt(c)}`:i+=d}return i}function Be(e){return e==null?!1:typeof e=="number"||/^0x[0-9a-f]+$/i.test(e)?!0:/^0[^.]/.test(e)?!1:/^[-]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(e)}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */function ft(e){if(Array.isArray(e))return e.map(d=>typeof d!="string"?d+"":d);e=e.trim();let t=0,s=null,i=null,c=null;const f=[];for(let d=0;d<e.length;d++){if(s=i,i=e.charAt(d),i===" "&&!c){s!==" "&&t++;continue}i===c?c=null:(i==="'"||i==='"')&&!c&&(c=i),f[t]||(f[t]=""),f[t]+=i}return f}/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var L;(function(e){e.BOOLEAN="boolean",e.STRING="string",e.NUMBER="number",e.ARRAY="array"})(L||(L={}));/**
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */let I;class ut{constructor(t){I=t}parse(t,s){const i=Object.assign({alias:void 0,array:void 0,boolean:void 0,config:void 0,configObjects:void 0,configuration:void 0,coerce:void 0,count:void 0,default:void 0,envPrefix:void 0,narg:void 0,normalize:void 0,string:void 0,number:void 0,__:void 0,key:void 0},s),c=ft(t),f=typeof t=="string",d=ht(Object.assign(Object.create(null),i.alias)),m=Object.assign({"boolean-negation":!0,"camel-case-expansion":!0,"combine-arrays":!1,"dot-notation":!0,"duplicate-arguments-array":!0,"flatten-duplicate-arrays":!0,"greedy-arrays":!0,"halt-at-non-option":!1,"nargs-eats-options":!1,"negation-prefix":"no-","parse-numbers":!0,"parse-positional-numbers":!0,"populate--":!1,"set-placeholder-key":!1,"short-option-groups":!0,"strip-aliased":!1,"strip-dashed":!1,"unknown-options-as-args":!1},i.configuration),E=Object.assign(Object.create(null),i.default),j=i.configObjects||[],_=i.envPrefix,q=m["populate--"],G=q?"--":"_",ye=Object.create(null),Je=Object.create(null),D=i.__||I.format,l={aliases:Object.create(null),arrays:Object.create(null),bools:Object.create(null),strings:Object.create(null),numbers:Object.create(null),counts:Object.create(null),normalize:Object.create(null),configs:Object.create(null),nargs:Object.create(null),coercions:Object.create(null),keys:[]},B=/^-([0-9]+(\.[0-9]+)?|\.[0-9]+)$/,Ne=new RegExp("^--"+m["negation-prefix"]+"(.+)");[].concat(i.array||[]).filter(Boolean).forEach(function(n){const r=typeof n=="object"?n.key:n,u=Object.keys(n).map(function(a){return{boolean:"bools",string:"strings",number:"numbers"}[a]}).filter(Boolean).pop();u&&(l[u][r]=!0),l.arrays[r]=!0,l.keys.push(r)}),[].concat(i.boolean||[]).filter(Boolean).forEach(function(n){l.bools[n]=!0,l.keys.push(n)}),[].concat(i.string||[]).filter(Boolean).forEach(function(n){l.strings[n]=!0,l.keys.push(n)}),[].concat(i.number||[]).filter(Boolean).forEach(function(n){l.numbers[n]=!0,l.keys.push(n)}),[].concat(i.count||[]).filter(Boolean).forEach(function(n){l.counts[n]=!0,l.keys.push(n)}),[].concat(i.normalize||[]).filter(Boolean).forEach(function(n){l.normalize[n]=!0,l.keys.push(n)}),typeof i.narg=="object"&&Object.entries(i.narg).forEach(([n,r])=>{typeof r=="number"&&(l.nargs[n]=r,l.keys.push(n))}),typeof i.coerce=="object"&&Object.entries(i.coerce).forEach(([n,r])=>{typeof r=="function"&&(l.coercions[n]=r,l.keys.push(n))}),typeof i.config<"u"&&(Array.isArray(i.config)||typeof i.config=="string"?[].concat(i.config).filter(Boolean).forEach(function(n){l.configs[n]=!0}):typeof i.config=="object"&&Object.entries(i.config).forEach(([n,r])=>{(typeof r=="boolean"||typeof r=="function")&&(l.configs[n]=r)})),En(i.key,d,i.default,l.arrays),Object.keys(E).forEach(function(n){(l.aliases[n]||[]).forEach(function(r){E[r]=E[n]})});let P=null;jn();let be=[];const w=Object.assign(Object.create(null),{_:[]}),ke={};for(let n=0;n<c.length;n++){const r=c[n],u=r.replace(/^-{3,}/,"---");let a,o,p,h,g,O;if(r!=="--"&&/^-/.test(r)&&_e(r))ve(r);else if(u.match(/^---+(=|$)/)){ve(r);continue}else if(r.match(/^--.+=/)||!m["short-option-groups"]&&r.match(/^-.+=/))h=r.match(/^--?([^=]+)=([\s\S]*)$/),h!==null&&Array.isArray(h)&&h.length>=3&&(b(h[1],l.arrays)?n=Ee(n,h[1],c,h[2]):b(h[1],l.nargs)!==!1?n=$e(n,h[1],c,h[2]):$(h[1],h[2],!0));else if(r.match(Ne)&&m["boolean-negation"])h=r.match(Ne),h!==null&&Array.isArray(h)&&h.length>=2&&(o=h[1],$(o,b(o,l.arrays)?[!1]:!1));else if(r.match(/^--.+/)||!m["short-option-groups"]&&r.match(/^-[^-]+/))h=r.match(/^--?(.+)/),h!==null&&Array.isArray(h)&&h.length>=2&&(o=h[1],b(o,l.arrays)?n=Ee(n,o,c):b(o,l.nargs)!==!1?n=$e(n,o,c):(g=c[n+1],g!==void 0&&(!g.match(/^-/)||g.match(B))&&!b(o,l.bools)&&!b(o,l.counts)||/^(true|false)$/.test(g)?($(o,g),n++):$(o,Z(o))));else if(r.match(/^-.\..+=/))h=r.match(/^-([^=]+)=([\s\S]*)$/),h!==null&&Array.isArray(h)&&h.length>=3&&$(h[1],h[2]);else if(r.match(/^-.\..+/)&&!r.match(B))g=c[n+1],h=r.match(/^-(.\..+)/),h!==null&&Array.isArray(h)&&h.length>=2&&(o=h[1],g!==void 0&&!g.match(/^-/)&&!b(o,l.bools)&&!b(o,l.counts)?($(o,g),n++):$(o,Z(o)));else if(r.match(/^-[^-]+/)&&!r.match(B)){p=r.slice(1,-1).split(""),a=!1;for(let C=0;C<p.length;C++){if(g=r.slice(C+2),p[C+1]&&p[C+1]==="="){O=r.slice(C+3),o=p[C],b(o,l.arrays)?n=Ee(n,o,c,O):b(o,l.nargs)!==!1?n=$e(n,o,c,O):$(o,O),a=!0;break}if(g==="-"){$(p[C],g);continue}if(/[A-Za-z]/.test(p[C])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(g)&&b(g,l.bools)===!1){$(p[C],g),a=!0;break}if(p[C+1]&&p[C+1].match(/\W/)){$(p[C],g),a=!0;break}else $(p[C],Z(p[C]))}o=r.slice(-1)[0],!a&&o!=="-"&&(b(o,l.arrays)?n=Ee(n,o,c):b(o,l.nargs)!==!1?n=$e(n,o,c):(g=c[n+1],g!==void 0&&(!/^(-|--)[^-]/.test(g)||g.match(B))&&!b(o,l.bools)&&!b(o,l.counts)||/^(true|false)$/.test(g)?($(o,g),n++):$(o,Z(o))))}else if(r.match(/^-[0-9]$/)&&r.match(B)&&b(r.slice(1),l.bools))o=r.slice(1),$(o,Z(o));else if(r==="--"){be=c.slice(n+1);break}else if(m["halt-at-non-option"]){be=c.slice(n);break}else ve(r)}tt(w,!0),tt(w,!1),mn(w),yn(),nt(w,l.aliases,E,!0),bn(w),m["set-placeholder-key"]&&$n(w),Object.keys(l.counts).forEach(function(n){de(w,n.split("."))||$(n,0)}),q&&be.length&&(w[G]=[]),be.forEach(function(n){w[G].push(n)}),m["camel-case-expansion"]&&m["strip-dashed"]&&Object.keys(w).filter(n=>n!=="--"&&n.includes("-")).forEach(n=>{delete w[n]}),m["strip-aliased"]&&[].concat(...Object.keys(d).map(n=>d[n])).forEach(n=>{m["camel-case-expansion"]&&n.includes("-")&&delete w[n.split(".").map(r=>H(r)).join(".")],delete w[n]});function ve(n){const r=Ae("_",n);(typeof r=="string"||typeof r=="number")&&w._.push(r)}function $e(n,r,u,a){let o,p=b(r,l.nargs);if(p=typeof p!="number"||isNaN(p)?1:p,p===0)return M(a)||(P=Error(D("Argument unexpected for: %s",r))),$(r,Z(r)),n;let h=M(a)?0:1;if(m["nargs-eats-options"])u.length-(n+1)+h<p&&(P=Error(D("Not enough arguments following: %s",r))),h=p;else{for(o=n+1;o<u.length&&(!u[o].match(/^-[^0-9]/)||u[o].match(B)||_e(u[o]));o++)h++;h<p&&(P=Error(D("Not enough arguments following: %s",r)))}let g=Math.min(h,p);for(!M(a)&&g>0&&($(r,a),g--),o=n+1;o<g+n+1;o++)$(r,u[o]);return n+g}function Ee(n,r,u,a){let o=[],p=a||u[n+1];const h=b(r,l.nargs);if(b(r,l.bools)&&!/^(true|false)$/.test(p))o.push(!0);else if(M(p)||M(a)&&/^-/.test(p)&&!B.test(p)&&!_e(p)){if(E[r]!==void 0){const g=E[r];o=Array.isArray(g)?g:[g]}}else{M(a)||o.push(Fe(r,a,!0));for(let g=n+1;g<u.length&&!(!m["greedy-arrays"]&&o.length>0||h&&typeof h=="number"&&o.length>=h||(p=u[g],/^-/.test(p)&&!B.test(p)&&!_e(p)));g++)n=g,o.push(Fe(r,p,f))}return typeof h=="number"&&(h&&o.length<h||isNaN(h)&&o.length===0)&&(P=Error(D("Not enough arguments following: %s",r))),$(r,o),n}function $(n,r,u=f){if(/-/.test(n)&&m["camel-case-expansion"]){const p=n.split(".").map(function(h){return H(h)}).join(".");et(n,p)}const a=Fe(n,r,u),o=n.split(".");pe(w,o,a),l.aliases[n]&&l.aliases[n].forEach(function(p){const h=p.split(".");pe(w,h,a)}),o.length>1&&m["dot-notation"]&&(l.aliases[o[0]]||[]).forEach(function(p){let h=p.split(".");const g=[].concat(o);g.shift(),h=h.concat(g),(l.aliases[n]||[]).includes(h.join("."))||pe(w,h,a)}),b(n,l.normalize)&&!b(n,l.arrays)&&[n].concat(l.aliases[n]||[]).forEach(function(h){Object.defineProperty(ke,h,{enumerable:!0,get(){return r},set(g){r=typeof g=="string"?I.normalize(g):g}})})}function et(n,r){l.aliases[n]&&l.aliases[n].length||(l.aliases[n]=[r],ye[r]=!0),l.aliases[r]&&l.aliases[r].length||et(r,n)}function Fe(n,r,u){u&&(r=dt(r)),(b(n,l.bools)||b(n,l.counts))&&typeof r=="string"&&(r=r==="true");let a=Array.isArray(r)?r.map(function(o){return Ae(n,o)}):Ae(n,r);return b(n,l.counts)&&(M(a)||typeof a=="boolean")&&(a=we()),b(n,l.normalize)&&b(n,l.arrays)&&(Array.isArray(r)?a=r.map(o=>I.normalize(o)):a=I.normalize(r)),a}function Ae(n,r){return!m["parse-positional-numbers"]&&n==="_"||!b(n,l.strings)&&!b(n,l.bools)&&!Array.isArray(r)&&(Be(r)&&m["parse-numbers"]&&Number.isSafeInteger(Math.floor(parseFloat(`${r}`)))||!M(r)&&b(n,l.numbers))&&(r=Number(r)),r}function mn(n){const r=Object.create(null);nt(r,l.aliases,E),Object.keys(l.configs).forEach(function(u){const a=n[u]||r[u];if(a)try{let o=null;const p=I.resolve(I.cwd(),a),h=l.configs[u];if(typeof h=="function"){try{o=h(p)}catch(g){o=g}if(o instanceof Error){P=o;return}}else o=I.require(p);Re(o)}catch(o){o.name==="PermissionDenied"?P=o:n[u]&&(P=Error(D("Invalid JSON config file: %s",a)))}})}function Re(n,r){Object.keys(n).forEach(function(u){const a=n[u],o=r?r+"."+u:u;typeof a=="object"&&a!==null&&!Array.isArray(a)&&m["dot-notation"]?Re(a,o):(!de(w,o.split("."))||b(o,l.arrays)&&m["combine-arrays"])&&$(o,a)})}function yn(){typeof j<"u"&&j.forEach(function(n){Re(n)})}function tt(n,r){if(typeof _>"u")return;const u=typeof _=="string"?_:"",a=I.env();Object.keys(a).forEach(function(o){if(u===""||o.lastIndexOf(u,0)===0){const p=o.split("__").map(function(h,g){return g===0&&(h=h.substring(u.length)),H(h)});(r&&l.configs[p.join(".")]||!r)&&!de(n,p)&&$(p.join("."),a[o])}})}function bn(n){let r;const u=new Set;Object.keys(n).forEach(function(a){if(!u.has(a)&&(r=b(a,l.coercions),typeof r=="function"))try{const o=Ae(a,r(n[a]));[].concat(l.aliases[a]||[],a).forEach(p=>{u.add(p),n[p]=o})}catch(o){P=o}})}function $n(n){return l.keys.forEach(r=>{~r.indexOf(".")||typeof n[r]>"u"&&(n[r]=void 0)}),n}function nt(n,r,u,a=!1){Object.keys(u).forEach(function(o){de(n,o.split("."))||(pe(n,o.split("."),u[o]),a&&(Je[o]=!0),(r[o]||[]).forEach(function(p){de(n,p.split("."))||pe(n,p.split("."),u[o])}))})}function de(n,r){let u=n;m["dot-notation"]||(r=[r.join(".")]),r.slice(0,-1).forEach(function(o){u=u[o]||{}});const a=r[r.length-1];return typeof u!="object"?!1:a in u}function pe(n,r,u){let a=n;m["dot-notation"]||(r=[r.join(".")]),r.slice(0,-1).forEach(function(O){O=Ie(O),typeof a=="object"&&a[O]===void 0&&(a[O]={}),typeof a[O]!="object"||Array.isArray(a[O])?(Array.isArray(a[O])?a[O].push({}):a[O]=[a[O],{}],a=a[O][a[O].length-1]):a=a[O]});const o=Ie(r[r.length-1]),p=b(r.join("."),l.arrays),h=Array.isArray(u);let g=m["duplicate-arguments-array"];!g&&b(o,l.nargs)&&(g=!0,(!M(a[o])&&l.nargs[o]===1||Array.isArray(a[o])&&a[o].length===l.nargs[o])&&(a[o]=void 0)),u===we()?a[o]=we(a[o]):Array.isArray(a[o])?g&&p&&h?a[o]=m["flatten-duplicate-arrays"]?a[o].concat(u):(Array.isArray(a[o][0])?a[o]:[a[o]]).concat([u]):!g&&!!p==!!h?a[o]=u:a[o]=a[o].concat([u]):a[o]===void 0&&p?a[o]=h?u:[u]:g&&!(a[o]===void 0||b(o,l.counts)||b(o,l.bools))?a[o]=[a[o],u]:a[o]=u}function En(...n){n.forEach(function(r){Object.keys(r||{}).forEach(function(u){l.aliases[u]||(l.aliases[u]=[].concat(d[u]||[]),l.aliases[u].concat(u).forEach(function(a){if(/-/.test(a)&&m["camel-case-expansion"]){const o=H(a);o!==u&&l.aliases[u].indexOf(o)===-1&&(l.aliases[u].push(o),ye[o]=!0)}}),l.aliases[u].concat(u).forEach(function(a){if(a.length>1&&/[A-Z]/.test(a)&&m["camel-case-expansion"]){const o=Te(a,"-");o!==u&&l.aliases[u].indexOf(o)===-1&&(l.aliases[u].push(o),ye[o]=!0)}}),l.aliases[u].forEach(function(a){l.aliases[a]=[u].concat(l.aliases[u].filter(function(o){return a!==o}))}))})})}function b(n,r){const u=[].concat(l.aliases[n]||[],n),a=Object.keys(r),o=u.find(p=>a.includes(p));return o?r[o]:!1}function st(n){const r=Object.keys(l);return[].concat(r.map(a=>l[a])).some(function(a){return Array.isArray(a)?a.includes(n):a[n]})}function An(n,...r){return[].concat(...r).some(function(a){const o=n.match(a);return o&&st(o[1])})}function _n(n){if(n.match(B)||!n.match(/^-[^-]+/))return!1;let r=!0,u;const a=n.slice(1).split("");for(let o=0;o<a.length;o++){if(u=n.slice(o+2),!st(a[o])){r=!1;break}if(a[o+1]&&a[o+1]==="="||u==="-"||/[A-Za-z]/.test(a[o])&&/^-?\d+(\.\d*)?(e-?\d+)?$/.test(u)||a[o+1]&&a[o+1].match(/\W/))break}return r}function _e(n){return m["unknown-options-as-args"]&&wn(n)}function wn(n){return n=n.replace(/^-{3,}/,"--"),n.match(B)||_n(n)?!1:!An(n,/^-+([^=]+?)=[\s\S]*$/,Ne,/^-+([^=]+?)$/,/^-+([^=]+?)-$/,/^-+([^=]+?\d+)$/,/^-+([^=]+?)\W+.*$/)}function Z(n){return!b(n,l.bools)&&!b(n,l.counts)&&`${n}`in E?E[n]:On(xn(n))}function On(n){return{[L.BOOLEAN]:!0,[L.STRING]:"",[L.NUMBER]:void 0,[L.ARRAY]:[]}[n]}function xn(n){let r=L.BOOLEAN;return b(n,l.strings)?r=L.STRING:b(n,l.numbers)?r=L.NUMBER:b(n,l.bools)?r=L.BOOLEAN:b(n,l.arrays)&&(r=L.ARRAY),r}function M(n){return n===void 0}function jn(){Object.keys(l.counts).find(n=>b(n,l.arrays)?(P=Error(D("Invalid configuration: %s, opts.count excludes opts.array.",n)),!0):b(n,l.nargs)?(P=Error(D("Invalid configuration: %s, opts.count excludes opts.narg.",n)),!0):!1)}return{aliases:Object.assign({},l.aliases),argv:Object.assign(ke,w),configuration:m,defaulted:Object.assign({},Je),error:P,newAliases:Object.assign({},ye)}}}function ht(e){const t=[],s=Object.create(null);let i=!0;for(Object.keys(e).forEach(function(c){t.push([].concat(e[c],c))});i;){i=!1;for(let c=0;c<t.length;c++)for(let f=c+1;f<t.length;f++)if(t[c].filter(function(m){return t[f].indexOf(m)!==-1}).length){t[c]=t[c].concat(t[f]),t.splice(f,1),i=!0;break}}return t.forEach(function(c){c=c.filter(function(d,m,E){return E.indexOf(d)===m});const f=c.pop();f!==void 0&&typeof f=="string"&&(s[f]=c)}),s}function we(e){return e!==void 0?e+1:1}function Ie(e){return e==="__proto__"?"___proto___":e}function dt(e){return typeof e=="string"&&(e[0]==="'"||e[0]==='"')&&e[e.length-1]===e[0]?e.substring(1,e.length-1):e}/**
 * @fileoverview Main entrypoint for libraries using yargs-parser in Node.js
 * CJS and ESM environments.
 *
 * @license
 * Copyright (c) 2016, Contributors
 * SPDX-License-Identifier: ISC
 */var Oe,xe,je;const ze=process&&process.env&&process.env.YARGS_MIN_NODE_VERSION?Number(process.env.YARGS_MIN_NODE_VERSION):12,qe=(xe=(Oe=process==null?void 0:process.versions)===null||Oe===void 0?void 0:Oe.node)!==null&&xe!==void 0?xe:(je=process==null?void 0:process.version)===null||je===void 0?void 0:je.slice(1);if(qe&&Number(qe.match(/^([^.]+)/)[1])<ze)throw Error(`yargs parser supports a minimum Node.js version of ${ze}. Read our version support policy: https://github.com/yargs/yargs-parser#supported-nodejs-versions`);const pt=process?process.env:{},Me=new ut({cwd:process.cwd,env:()=>pt,format:V.format,normalize:x.normalize,resolve:x.resolve,require:e=>{if(typeof require<"u")return require(e);if(e.match(/\.json$/))return JSON.parse(T.readFileSync(e,"utf8"));throw Error("only .json config files are supported in ESM")}}),X=function(t,s){return Me.parse(t.slice(),s).argv};X.detailed=function(e,t){return Me.parse(e.slice(),t)},X.camelCase=H,X.decamelize=Te,X.looksLikeNumber=Be;const gt={right:At,center:_t},mt=0,ge=1,yt=2,me=3;class bt{constructor(t){var s;this.width=t.width,this.wrap=(s=t.wrap)!==null&&s!==void 0?s:!0,this.rows=[]}span(...t){const s=this.div(...t);s.span=!0}resetOutput(){this.rows=[]}div(...t){if(t.length===0&&this.div(""),this.wrap&&this.shouldApplyLayoutDSL(...t)&&typeof t[0]=="string")return this.applyLayoutDSL(t[0]);const s=t.map(i=>typeof i=="string"?this.colFromString(i):i);return this.rows.push(s),s}shouldApplyLayoutDSL(...t){return t.length===1&&typeof t[0]=="string"&&/[\t\n]/.test(t[0])}applyLayoutDSL(t){const s=t.split(`
`).map(c=>c.split("	"));let i=0;return s.forEach(c=>{c.length>1&&S.stringWidth(c[0])>i&&(i=Math.min(Math.floor(this.width*.5),S.stringWidth(c[0])))}),s.forEach(c=>{this.div(...c.map((f,d)=>({text:f.trim(),padding:this.measurePadding(f),width:d===0&&c.length>1?i:void 0})))}),this.rows[this.rows.length-1]}colFromString(t){return{text:t,padding:this.measurePadding(t)}}measurePadding(t){const s=S.stripAnsi(t);return[0,s.match(/\s*$/)[0].length,0,s.match(/^\s*/)[0].length]}toString(){const t=[];return this.rows.forEach(s=>{this.rowToString(s,t)}),t.filter(s=>!s.hidden).map(s=>s.text).join(`
`)}rowToString(t,s){return this.rasterize(t).forEach((i,c)=>{let f="";i.forEach((d,m)=>{const{width:E}=t[m],j=this.negatePadding(t[m]);let _=d;if(j>S.stringWidth(d)&&(_+=" ".repeat(j-S.stringWidth(d))),t[m].align&&t[m].align!=="left"&&this.wrap){const G=gt[t[m].align];_=G(_,j),S.stringWidth(_)<j&&(_+=" ".repeat((E||0)-S.stringWidth(_)-1))}const q=t[m].padding||[0,0,0,0];q[me]&&(f+=" ".repeat(q[me])),f+=Ue(t[m],_,"| "),f+=_,f+=Ue(t[m],_," |"),q[ge]&&(f+=" ".repeat(q[ge])),c===0&&s.length>0&&(f=this.renderInline(f,s[s.length-1]))}),s.push({text:f.replace(/ +$/,""),span:t.span})}),s}renderInline(t,s){const i=t.match(/^ */),c=i?i[0].length:0,f=s.text,d=S.stringWidth(f.trimRight());return s.span?this.wrap?c<d?t:(s.hidden=!0,f.trimRight()+" ".repeat(c-d)+t.trimLeft()):(s.hidden=!0,f+t):t}rasterize(t){const s=[],i=this.columnWidths(t);let c;return t.forEach((f,d)=>{f.width=i[d],this.wrap?c=S.wrap(f.text,this.negatePadding(f),{hard:!0}).split(`
`):c=f.text.split(`
`),f.border&&(c.unshift("."+"-".repeat(this.negatePadding(f)+2)+"."),c.push("'"+"-".repeat(this.negatePadding(f)+2)+"'")),f.padding&&(c.unshift(...new Array(f.padding[mt]||0).fill("")),c.push(...new Array(f.padding[yt]||0).fill(""))),c.forEach((m,E)=>{s[E]||s.push([]);const j=s[E];for(let _=0;_<d;_++)j[_]===void 0&&j.push("");j.push(m)})}),s}negatePadding(t){let s=t.width||0;return t.padding&&(s-=(t.padding[me]||0)+(t.padding[ge]||0)),t.border&&(s-=4),s}columnWidths(t){if(!this.wrap)return t.map(d=>d.width||S.stringWidth(d.text));let s=t.length,i=this.width;const c=t.map(d=>{if(d.width)return s--,i-=d.width,d.width}),f=s?Math.floor(i/s):0;return c.map((d,m)=>d===void 0?Math.max(f,$t(t[m])):d)}}function Ue(e,t,s){return e.border?/[.']-+[.']/.test(t)?"":t.trim().length!==0?s:"  ":""}function $t(e){const t=e.padding||[],s=1+(t[me]||0)+(t[ge]||0);return e.border?s+4:s}function Et(){return typeof process=="object"&&process.stdout&&process.stdout.columns?process.stdout.columns:80}function At(e,t){e=e.trim();const s=S.stringWidth(e);return s<t?" ".repeat(t-s)+e:e}function _t(e,t){e=e.trim();const s=S.stringWidth(e);return s>=t?e:" ".repeat(t-s>>1)+e}let S;function wt(e,t){return S=t,new bt({width:e?.width||Et(),wrap:e?.wrap})}const Ve=new RegExp("\x1B(?:\\[(?:\\d+[ABCDEFGJKSTm]|\\d+;\\d+[Hfm]|\\d+;\\d+;\\d+m|6n|s|u|\\?25[lh])|\\w)","g");function Ge(e){return e.replace(Ve,"")}function Ot(e,t){const[s,i]=e.match(Ve)||["",""];e=Ge(e);let c="";for(let f=0;f<e.length;f++)f!==0&&f%t===0&&(c+=`
`),c+=e.charAt(f);return s&&i&&(c=`${s}${c}${i}`),c}function xt(e){return wt(e,{stringWidth:t=>[...t].length,stripAnsi:Ge,wrap:Ot})}function jt(e,t){let s=x.resolve(".",e),i;for(T.statSync(s).isDirectory()||(s=x.dirname(s));;){if(i=t(s,T.readdirSync(s)),i)return x.resolve(s,i);if(s=x.dirname(i=s),i===s)break}}const Ct={fs:{readFileSync:T.readFileSync,writeFile:T.writeFile},format:V.format,resolve:x.resolve,exists:e=>{try{return T.statSync(e).isFile()}catch{return!1}}};let W;class St{constructor(t){t=t||{},this.directory=t.directory||"./locales",this.updateFiles=typeof t.updateFiles=="boolean"?t.updateFiles:!0,this.locale=t.locale||"en",this.fallbackToLanguage=typeof t.fallbackToLanguage=="boolean"?t.fallbackToLanguage:!0,this.cache=Object.create(null),this.writeQueue=[]}__(...t){if(typeof arguments[0]!="string")return this._taggedLiteral(arguments[0],...arguments);const s=t.shift();let i=function(){};return typeof t[t.length-1]=="function"&&(i=t.pop()),i=i||function(){},this.cache[this.locale]||this._readLocaleFile(),!this.cache[this.locale][s]&&this.updateFiles?(this.cache[this.locale][s]=s,this._enqueueWrite({directory:this.directory,locale:this.locale,cb:i})):i(),W.format.apply(W.format,[this.cache[this.locale][s]||s].concat(t))}__n(){const t=Array.prototype.slice.call(arguments),s=t.shift(),i=t.shift(),c=t.shift();let f=function(){};typeof t[t.length-1]=="function"&&(f=t.pop()),this.cache[this.locale]||this._readLocaleFile();let d=c===1?s:i;this.cache[this.locale][s]&&(d=this.cache[this.locale][s][c===1?"one":"other"]),!this.cache[this.locale][s]&&this.updateFiles?(this.cache[this.locale][s]={one:s,other:i},this._enqueueWrite({directory:this.directory,locale:this.locale,cb:f})):f();const m=[d];return~d.indexOf("%d")&&m.push(c),W.format.apply(W.format,m.concat(t))}setLocale(t){this.locale=t}getLocale(){return this.locale}updateLocale(t){this.cache[this.locale]||this._readLocaleFile();for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(this.cache[this.locale][s]=t[s])}_taggedLiteral(t,...s){let i="";return t.forEach(function(c,f){const d=s[f+1];i+=c,typeof d<"u"&&(i+="%s")}),this.__.apply(this,[i].concat([].slice.call(s,1)))}_enqueueWrite(t){this.writeQueue.push(t),this.writeQueue.length===1&&this._processWriteQueue()}_processWriteQueue(){const t=this,s=this.writeQueue[0],i=s.directory,c=s.locale,f=s.cb,d=this._resolveLocaleFile(i,c),m=JSON.stringify(this.cache[c],null,2);W.fs.writeFile(d,m,"utf-8",function(E){t.writeQueue.shift(),t.writeQueue.length>0&&t._processWriteQueue(),f(E)})}_readLocaleFile(){let t={};const s=this._resolveLocaleFile(this.directory,this.locale);try{W.fs.readFileSync&&(t=JSON.parse(W.fs.readFileSync(s,"utf-8")))}catch(i){if(i instanceof SyntaxError&&(i.message="syntax error in "+s),i.code==="ENOENT")t={};else throw i}this.cache[this.locale]=t}_resolveLocaleFile(t,s){let i=W.resolve(t,"./",s+".json");if(this.fallbackToLanguage&&!this._fileExistsSync(i)&&~s.lastIndexOf("_")){const c=W.resolve(t,"./",s.split("_")[0]+".json");this._fileExistsSync(c)&&(i=c)}return i}_fileExistsSync(t){return W.exists(t)}}function Nt(e,t){W=t;const s=new St(e);return{__:s.__.bind(s),__n:s.__n.bind(s),setLocale:s.setLocale.bind(s),getLocale:s.getLocale.bind(s),updateLocale:s.updateLocale.bind(s),locale:s.locale}}const vt=e=>Nt(e,Ct),Ft="require is not supported by ESM",De="loading a directory of commands is not supported yet for ESM";let J;try{J=ot.fileURLToPath(typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:We&&We.src||new URL("vue-mess-detector.umd.js",document.baseURI).href)}catch{J=process.cwd()}const Rt=J.substring(0,J.lastIndexOf("node_modules"));Le.notStrictEqual,Le.strictEqual,V.inspect,Rt||process.cwd(),x.basename,x.dirname,x.extname,x.relative,x.resolve,process.cwd,process.exit,process.nextTick,typeof process.stdout.columns<"u"&&process.stdout.columns,T.readFileSync,vt({directory:x.resolve(J,"../../../locales"),updateFiles:!1});const Ce="\x1B[44m",Q="\x1B[43m",N="\x1B[41m",Lt="\x1B[42m",A="\x1B[0m",v="\x1B[33m",F="\x1B[0m",Se=50,k=[],Wt=(e,t)=>{const s=e.content.split(`
`);s.length>Se&&k.push({fileName:t,scriptLength:s.length})},Pt=()=>(k.length>0&&(console.log(`
${N}Long <script> blocks${A} in ${k.length} files.`),console.log(`ðŸ‘‰ ${v}Try to refactor out the logic into composable functions or other files and keep the script block's length under ${Se} lines.${F}`),k.forEach(e=>{console.log(`- ${e.fileName} ${e.scriptLength>Se*2?N:Q}(${e.scriptLength} lines)${A}`)})),k.length),ee=[],Tt=e=>{ee.push(e)},Bt=()=>(ee.length>0&&(console.log(`
${Q}Plain <script> blocks${A} in ${ee.length} files.`),console.log(`ðŸ‘‰ ${v} Consider using <script setup> to leverage the new SFC <script> syntax.${F}`),ee.forEach(e=>{console.log(`- ${e}`)})),ee.length),te=[],It=(e,t)=>{const s=/\belse\b/gi,i=e.content.match(s);i?.length&&te.push({fileName:t,elseCount:i.length})},zt=()=>(te.length>0&&(console.log(`
${Q}else conditions${A} are used in ${te.length} files.`),console.log(`ðŸ‘‰ ${v}Try to rewrite the conditions in a way that the else clause is not necessary.${F}`),te.forEach(e=>{console.log(`- ${e.fileName} ${Q}(${e.elseCount})${A}`)})),te.length),qt=5,Mt=10,ne=[],Ut=(e,t)=>{const s=/\bif\b/gi,i=/\belse\b/gi,c=/\bfor\b/gi,f=/\bwhile\b/gi,d=/\bcase\b/gi,m=e.content.match(s),E=e.content.match(i),j=e.content.match(c),_=e.content.match(f),q=e.content.match(d),G=(m?.length||0)+(E?.length||0)+(j?.length||0)+(_?.length||0)+(q?.length||0);G>qt&&ne.push({fileName:t,cyclomaticComplexity:G})},Vt=()=>(ne.length>0&&(console.log(`
${Ce}cyclomaticComplexity${A} is above moderate in ${ne.length} files.`),console.log(`ðŸ‘‰ ${v}Try to reduce complexity.${F}`),ne.forEach(e=>{console.log(`- ${e.fileName} ${e.cyclomaticComplexity>Mt?N:Q}(${e.cyclomaticComplexity})${A}`)})),ne.length),se=[],Gt=e=>{if(e.includes("pages"))return;const t=x.basename(e);if(t==="App.vue")return;const s=/[A-Z]/;t.slice(1).match(s)?.length||se.push({filePath:e})},Dt=()=>(se.length>0&&(console.log(`
${N}single name component${A} is used in ${se.length} files.`),console.log(`ðŸ‘‰ ${v}Rename the component to use multi-word name.${F} See: https://vuejs.org/style-guide/rules-essential.html#use-multi-word-component-names`),se.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),se.length),oe=[],Qt=(e,t)=>{e.scoped||oe.push({filePath:t})},Kt=()=>(oe.length>0&&(console.log(`
${N}Global style ${A} is used in ${oe.length} files.`),console.log(`ðŸ‘‰ ${v}Use <style scoped>.${F} See: https://vuejs.org/style-guide/rules-essential.html#use-component-scoped-styling`),oe.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),oe.length),re=[],Zt=(e,t)=>{const s=/defineProps\(\[/gi;e.content.match(s)?.length&&re.push({filePath:t})},Yt=()=>(re.length>0&&(console.log(`
${N}simple prop${A} is used in ${re.length} files.`),console.log(`ðŸ‘‰ ${v}Add at least type definition.${F} See: https://vuejs.org/style-guide/rules-essential.html#use-detailed-prop-definitions`),re.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),re.length),ie=[],Ht=(e,t)=>{const s=/<[^>]+ v-if[^>]+ v-for[^>]+>/gi,i=/<[^>]+ v-for[^>]+ v-if[^>]+>/gi,c=e.content.match(s),f=e.content.match(i);(c?.length||f?.length)&&ie.push({filePath:t})},Xt=()=>(ie.length>0&&(console.log(`
${N}v-if used with v-for${A} in ${ie.length} files.`),console.log(`ðŸ‘‰ ${v}Move out the v-if to a computed property.${F} See: https://vuejs.org/style-guide/rules-essential.html#avoid-v-if-with-v-for`),ie.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),ie.length),ce=[],Jt=(e,t)=>{const s=/<[^>]+ v-for[^>]+>/gi,i=e.content.match(s);i?.length&&(i.some(f=>f.includes(":key"))||ce.push({filePath:t}))},kt=()=>(ce.length>0&&(console.log(`
${N}v-for has no key${A} in ${ce.length} files.`),console.log(`ðŸ‘‰ ${v}Add a \`:key\` property to all v-for.${F} See: https://vuejs.org/style-guide/rules-essential.html#use-keyed-v-for`),ce.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),ce.length),ae=[],en=e=>{const t=x.basename(e),s=/^[A-Z][a-zA-Z0-9]+(?:(?<!^)(?=[A-Z]))*.vue$/,i=t.match(s),c=/^([a-z0-9]+-)+[a-z0-9]+\.vue$/,f=t.match(c);!i?.length&&!f?.length&&ae.push({fileName:e})},tn=()=>(ae.length>0&&(console.log(`
${N}component name is not PascalCase and not kebab-abse${A} in ${ae.length} files.`),console.log(`ðŸ‘‰ ${v}Rename the component to use PascalCase or kebab-case file name.${F} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#single-file-component-filename-casing`),ae.forEach(e=>{console.log(`- ${N}${e.fileName}${A}`)})),ae.length),le=[],nn=/^[a-z]+([A-Z][a-z]*)+$/,sn=(e,t)=>{const s=/defineProps\({([^}]+)/g;let i;for(;(i=s.exec(e.content))!==null;)i[1].replace(/\s+/g,"").replace(/["']/g,"").split(",").map(f=>f.split(":")[0]).filter(f=>f.length).filter(f=>!nn.test(f)).length&&le.push({filePath:t})},on=()=>(le.length>0&&(console.log(`
${N}prop names are not camelCased${A} in ${le.length} files.`),console.log(`ðŸ‘‰ ${v}Rename the props to camelCase.${F} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#prop-name-casing`),le.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),le.length),K=[],rn=40,cn=(e,t)=>{const s=/{{\s*([\s\S]*?)\s*}}/g;[...e.content.matchAll(s)].map(c=>c[1].trim()).forEach(c=>{c.length>rn&&(K.some(f=>f.filePath===t)||K.push({filePath:t}))})},an=()=>(K.length>0&&(console.log(`
${N}Lengthy template expression${A} found in ${K.length} files.`),console.log(`ðŸ‘‰ ${v}Refactor the expression into a computed property.${F} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#simple-expressions-in-templates`),K.forEach(e=>{console.log(`- ${e.filePath} ðŸš¨`)})),K.length),ln=/^(\(.*\)|\\?.)$/;function U(e){const t=e.toString();return ln.test(t)?t:`(?:${t})`}const fn=/^(?:\(\?:(.+)\)|(\(?.+\)?))$/,un=/^(?:\(\?:(.+)\)([?+*]|{[\d,]+})?|(.+))$/;function y(e){const t=s=>y(`(?<${s}>${`${e}`.replace(fn,"$1$2")})`);return{toString:()=>e.toString(),and:Object.assign((...s)=>y(`${e}${z(...s)}`),{referenceTo:s=>y(`${e}\\k<${s}>`)}),or:(...s)=>y(`(?:${e}|${z(...s)})`),after:(...s)=>y(`(?<=${z(...s)})${e}`),before:(...s)=>y(`${e}(?=${z(...s)})`),notAfter:(...s)=>y(`(?<!${z(...s)})${e}`),notBefore:(...s)=>y(`${e}(?!${z(...s)})`),times:Object.assign(s=>y(`${U(e)}{${s}}`),{any:()=>y(`${U(e)}*`),atLeast:s=>y(`${U(e)}{${s},}`),atMost:s=>y(`${U(e)}{0,${s}}`),between:(s,i)=>y(`${U(e)}{${s},${i}}`)}),optionally:()=>y(`${U(e)}?`),as:t,groupedAs:t,grouped:()=>y(`${e}`.replace(un,"($1$3)$2")),at:{lineStart:()=>y(`^${e}`),lineEnd:()=>y(`${e}$`)}}}const hn=/[.*+?^${}()|[\]\\/]/g;function Qe(e){return y(`[${e.replace(/[-\\^\]]/g,"\\$&")}]`)}function Ke(e){return y(`[^${e.replace(/[-\\^\]]/g,"\\$&")}]`)}y("."),y("\\b\\w+\\b");const Ze=y("\\w");y("\\b"),y("\\d"),y("\\s"),Object.assign(y("[a-zA-Z]"),{lowercase:y("[a-z]"),uppercase:y("[A-Z]")}),y("\\t"),y("\\n"),y("\\r"),y("\\W+"),y("\\W"),y("\\B"),y("\\D"),y("\\S"),Object.assign(y("[^a-zA-Z]"),{lowercase:y("[^a-z]"),uppercase:y("[^A-Z]")}),y("[^\\t]"),y("[^\\n]"),y("[^\\r]");function fe(...e){return y(`${U(z(...e))}?`)}function z(...e){return y(e.map(t=>typeof t=="string"?t.replace(hn,"\\$&"):t).join(""))}function ue(...e){return y(`${U(z(...e))}+`)}const Ye=(...e)=>{const t=e.length>1&&(Array.isArray(e[e.length-1])||e[e.length-1]instanceof Set)?e.pop():void 0;return new RegExp(z(...e).toString(),[...t||""].join(""))},he=[],dn=(e,t)=>{const s=e.template,i=Ye("<",ue(Ze),fe(ue(Qe(` 	
\r`))),ue(Ke("/>")),fe(ue(Qe(` 	
\r`))),fe("/"),">",["g"]),c=s.content.match(i);if(c===null)return;const f=Ye(":",ue(Ze),fe(" "),"=",fe(" "),Ke(`'"`),["g"]);e.scriptSetup||e.script,c.forEach(d=>{if(!d.includes(":"))return;const m=d.match(f);if(m?.length){const j=e.source.split(`
`).findIndex(_=>_.includes(m[0]))+1;he.push({message:`${t}#${j} ${Q}${m}${A}`})}})},pn=()=>(he.length>0&&(console.log(`
${N}Attribute value is not quoted${A} in ${he.length} files.`),console.log(`ðŸ‘‰ ${v}Use quotes for attribute values.${F} See: https://vuejs.org/style-guide/rules-strongly-recommended.html#quoted-attribute-values`),he.forEach(e=>{console.log(`- ${e.message} ðŸš¨`)})),he.length);let He=0;const Xe=(e,t)=>{const s=T.readdirSync(e);He+=s.length;for(const i of s){const c=x.join(e,i);T.statSync(c).isDirectory()?Xe(c,t):i.endsWith(".vue")&&t(c)}},gn=e=>{console.log(`

${Ce}Analyzing Vue files in ${e}${A}`);let t=0;Xe(e,s=>{const i=T.readFileSync(s,"utf-8"),{descriptor:c}=rt.parse(i);Gt(s),en(s),c.script&&Tt(s);const f=c.scriptSetup||c.script;f&&(Zt(f,s),sn(f,s),Wt(f,s),Ut(f,s),It(f,s)),c.styles.forEach(d=>{Qt(d,s)}),c.template&&(Jt(c.template,s),Ht(c.template,s),cn(c.template,s),dn(c,s))}),console.log(`Found ${Ce}${He}${A} Vue files`),t+=Dt(),t+=Yt(),t+=kt(),t+=Xt(),t+=Kt(),t+=tn(),t+=on(),t+=an(),t+=pn(),t+=Pt(),t+=Bt(),t+=Vt(),t+=zt(),t||console.log(`${Lt}No code smells detected!${A}`)};R(at(process.argv)).command("analyze [path]","Analyze Vue files for code smells",e=>e.positional("path",{describe:"path to the Vue files",type:"string",default:"./src"}),e=>{gn(e.path)}).help().argv});
